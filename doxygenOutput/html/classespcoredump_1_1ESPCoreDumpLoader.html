<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Luva eletrônica: espcoredump.ESPCoreDumpLoader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Luva eletrônica
   </div>
   <div id="projectbrief">Project for capture hand posture through IMUs and esp32 Mcu.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>espcoredump</b></li><li class="navelem"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html">ESPCoreDumpLoader</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">espcoredump.ESPCoreDumpLoader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for espcoredump.ESPCoreDumpLoader:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classespcoredump_1_1ESPCoreDumpLoader.png" usemap="#espcoredump.ESPCoreDumpLoader_map" alt=""/>
  <map id="espcoredump.ESPCoreDumpLoader_map" name="espcoredump.ESPCoreDumpLoader_map">
<area href="classespcoredump_1_1ESPCoreDumpFileLoader.html" alt="espcoredump.ESPCoreDumpFileLoader" shape="rect" coords="0,112,247,136"/>
<area href="classespcoredump_1_1ESPCoreDumpFlashLoader.html" alt="espcoredump.ESPCoreDumpFlashLoader" shape="rect" coords="257,112,504,136"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0bc5bd2a670eaebd0e1e48387d672fa9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a0bc5bd2a670eaebd0e1e48387d672fa9">__init__</a> (self)</td></tr>
<tr class="separator:a0bc5bd2a670eaebd0e1e48387d672fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eb99313732885107fa9ca12bbae172a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a9eb99313732885107fa9ca12bbae172a">tcb_is_sane</a> (self, tcb_addr, tcb_size)</td></tr>
<tr class="separator:a9eb99313732885107fa9ca12bbae172a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fba2fe6ef576478482de8d1fff74978"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a4fba2fe6ef576478482de8d1fff74978">stack_is_sane</a> (self, sp)</td></tr>
<tr class="separator:a4fba2fe6ef576478482de8d1fff74978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2178c23df91d8eb2d469af9cd583644e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a2178c23df91d8eb2d469af9cd583644e">addr_is_fake</a> (self, addr)</td></tr>
<tr class="separator:a2178c23df91d8eb2d469af9cd583644e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c03e2dd86a5d13f8698d2290abee4f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a94c03e2dd86a5d13f8698d2290abee4f">remove_tmp_file</a> (self, fname)</td></tr>
<tr class="separator:a94c03e2dd86a5d13f8698d2290abee4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2fc97010dcceb5bf20e462c2c2174f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a7e2fc97010dcceb5bf20e462c2c2174f">cleanup</a> (self)</td></tr>
<tr class="separator:a7e2fc97010dcceb5bf20e462c2c2174f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca16b7ad4d1431b9467403991a48a10"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#afca16b7ad4d1431b9467403991a48a10">create_corefile</a> (self, core_fname=None, exe_name=None, rom_elf=None, off=0)</td></tr>
<tr class="separator:afca16b7ad4d1431b9467403991a48a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bca0f2bcf203dc9b6707ed2054f3920"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a1bca0f2bcf203dc9b6707ed2054f3920">read_data</a> (self, off, sz)</td></tr>
<tr class="separator:a1bca0f2bcf203dc9b6707ed2054f3920"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a99665db2961d46d55fe3ac657f5b9d7f"><td class="memItemLeft" align="right" valign="top"><a id="a99665db2961d46d55fe3ac657f5b9d7f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>fcore</b></td></tr>
<tr class="separator:a99665db2961d46d55fe3ac657f5b9d7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd0e37b51d91af81a0e99e38d1cf268"><td class="memItemLeft" align="right" valign="top"><a id="a6cd0e37b51d91af81a0e99e38d1cf268"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>hdr</b></td></tr>
<tr class="separator:a6cd0e37b51d91af81a0e99e38d1cf268"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a6c66d7cb71293dab408e01bb8e38d329"><td class="memItemLeft" align="right" valign="top"><a id="a6c66d7cb71293dab408e01bb8e38d329"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ESP_CORE_DUMP_CHIP_ESP32</b> = 0</td></tr>
<tr class="separator:a6c66d7cb71293dab408e01bb8e38d329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a614b9892ad058e67dfe536f58b0a48e5"><td class="memItemLeft" align="right" valign="top"><a id="a614b9892ad058e67dfe536f58b0a48e5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_VERSION_BIN_V1</b> = esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32, 0, 1)</td></tr>
<tr class="separator:a614b9892ad058e67dfe536f58b0a48e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160ca3e3f1c01a45d5c74e759a111544"><td class="memItemLeft" align="right" valign="top"><a id="a160ca3e3f1c01a45d5c74e759a111544"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_VERSION_BIN_V2</b> = esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32, 0, 2)</td></tr>
<tr class="separator:a160ca3e3f1c01a45d5c74e759a111544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae16fc3f143565d47ab88c16c847b0927"><td class="memItemLeft" align="right" valign="top"><a id="ae16fc3f143565d47ab88c16c847b0927"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_VERSION_ELF_CRC32</b> = esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32, 1, 0)</td></tr>
<tr class="separator:ae16fc3f143565d47ab88c16c847b0927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5111917e2e17fbd5a710cc81b98f3ce8"><td class="memItemLeft" align="right" valign="top"><a id="a5111917e2e17fbd5a710cc81b98f3ce8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_VERSION_ELF_SHA256</b> = esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32, 1, 1)</td></tr>
<tr class="separator:a5111917e2e17fbd5a710cc81b98f3ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ebad28ebde9a848c52235e001796220"><td class="memItemLeft" align="right" valign="top"><a id="a4ebad28ebde9a848c52235e001796220"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ESP_CORE_DUMP_INFO_TYPE</b> = 8266</td></tr>
<tr class="separator:a4ebad28ebde9a848c52235e001796220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad49d65e756130cf401dbf341fa6bb8"><td class="memItemLeft" align="right" valign="top"><a id="adad49d65e756130cf401dbf341fa6bb8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ESP_CORE_DUMP_TASK_INFO_TYPE</b> = 678</td></tr>
<tr class="separator:adad49d65e756130cf401dbf341fa6bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca128403cd63b60cf7a9516833705a5"><td class="memItemLeft" align="right" valign="top"><a id="acca128403cd63b60cf7a9516833705a5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ESP_CORE_DUMP_EXTRA_INFO_TYPE</b> = 677</td></tr>
<tr class="separator:acca128403cd63b60cf7a9516833705a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9354b0382f97d419bf75049108a8d11"><td class="memItemLeft" align="right" valign="top"><a id="aa9354b0382f97d419bf75049108a8d11"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>ESP_COREDUMP_CURR_TASK_MARKER</b> = 0xdeadbeef</td></tr>
<tr class="separator:aa9354b0382f97d419bf75049108a8d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee95517b4860c117ad4a249332225e6f"><td class="memItemLeft" align="right" valign="top"><a id="aee95517b4860c117ad4a249332225e6f"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_BIN_V1_HDR_FMT</b> = '&lt;4L'</td></tr>
<tr class="separator:aee95517b4860c117ad4a249332225e6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a662c3f998b690c6d182e14a80d700d6c"><td class="memItemLeft" align="right" valign="top"><a id="a662c3f998b690c6d182e14a80d700d6c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_BIN_V1_HDR_SZ</b> = struct.calcsize(ESP32_COREDUMP_BIN_V1_HDR_FMT)</td></tr>
<tr class="separator:a662c3f998b690c6d182e14a80d700d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27f1645c797b5456163cc2dd3021cdb"><td class="memItemLeft" align="right" valign="top"><a id="ad27f1645c797b5456163cc2dd3021cdb"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_HDR_FMT</b> = '&lt;5L'</td></tr>
<tr class="separator:ad27f1645c797b5456163cc2dd3021cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e31b52b940437262bf2aed5c6ff0f31"><td class="memItemLeft" align="right" valign="top"><a id="a9e31b52b940437262bf2aed5c6ff0f31"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_HDR_SZ</b> = struct.calcsize(ESP32_COREDUMP_HDR_FMT)</td></tr>
<tr class="separator:a9e31b52b940437262bf2aed5c6ff0f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973f347dc9f8f9568f4080689aecfd52"><td class="memItemLeft" align="right" valign="top"><a id="a973f347dc9f8f9568f4080689aecfd52"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_TSK_HDR_FMT</b> = '&lt;3L'</td></tr>
<tr class="separator:a973f347dc9f8f9568f4080689aecfd52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714e385c76b1c30c452167d352c1938d"><td class="memItemLeft" align="right" valign="top"><a id="a714e385c76b1c30c452167d352c1938d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_TSK_HDR_SZ</b> = struct.calcsize(ESP32_COREDUMP_TSK_HDR_FMT)</td></tr>
<tr class="separator:a714e385c76b1c30c452167d352c1938d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e91e226676898d4b11e91f3bcc90d05"><td class="memItemLeft" align="right" valign="top"><a id="a7e91e226676898d4b11e91f3bcc90d05"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_MEM_SEG_HDR_FMT</b> = '&lt;2L'</td></tr>
<tr class="separator:a7e91e226676898d4b11e91f3bcc90d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8664943e2dee6a89b9a433dc97e6fdf"><td class="memItemLeft" align="right" valign="top"><a id="ab8664943e2dee6a89b9a433dc97e6fdf"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_MEM_SEG_HDR_SZ</b> = struct.calcsize(ESP32_COREDUMP_MEM_SEG_HDR_FMT)</td></tr>
<tr class="separator:ab8664943e2dee6a89b9a433dc97e6fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeac2f151db69cdb453f51923d0c3038"><td class="memItemLeft" align="right" valign="top"><a id="adeac2f151db69cdb453f51923d0c3038"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_NOTE_HDR_FMT</b> = '&lt;3L'</td></tr>
<tr class="separator:adeac2f151db69cdb453f51923d0c3038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a861179ec63f1dfa06302284960aaec62"><td class="memItemLeft" align="right" valign="top"><a id="a861179ec63f1dfa06302284960aaec62"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_NOTE_HDR_SZ</b> = struct.calcsize(ESP32_COREDUMP_NOTE_HDR_FMT)</td></tr>
<tr class="separator:a861179ec63f1dfa06302284960aaec62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae64ce8d5d520cb13984814e2d9484de5"><td class="memItemLeft" align="right" valign="top"><a id="ae64ce8d5d520cb13984814e2d9484de5"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_CRC_FMT</b> = '&lt;L'</td></tr>
<tr class="separator:ae64ce8d5d520cb13984814e2d9484de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa51808a5f0809bac4da3144f53426269"><td class="memItemLeft" align="right" valign="top"><a id="aa51808a5f0809bac4da3144f53426269"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_CRC_SZ</b> = struct.calcsize(ESP32_COREDUMP_CRC_FMT)</td></tr>
<tr class="separator:aa51808a5f0809bac4da3144f53426269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e01a285657c15b677bd99e1e9cbe7d"><td class="memItemLeft" align="right" valign="top"><a id="a38e01a285657c15b677bd99e1e9cbe7d"></a>
string&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_SHA256_FMT</b> = '32c'</td></tr>
<tr class="separator:a38e01a285657c15b677bd99e1e9cbe7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e45d82c0f357bfc5d497d3b86629abd"><td class="memItemLeft" align="right" valign="top"><a id="a0e45d82c0f357bfc5d497d3b86629abd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ESP32_COREDUMP_SHA256_SZ</b> = struct.calcsize(ESP32_COREDUMP_SHA256_FMT)</td></tr>
<tr class="separator:a0e45d82c0f357bfc5d497d3b86629abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a65bbc5b449ecd26a55c854df72e36186"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a65bbc5b449ecd26a55c854df72e36186">_get_registers_from_stack</a> (self, data, grows_down)</td></tr>
<tr class="separator:a65bbc5b449ecd26a55c854df72e36186"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536e5e7ca863d8dbc6a7a4a465064ac3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a536e5e7ca863d8dbc6a7a4a465064ac3">_extract_elf_corefile</a> (self, core_fname=None, off=0, exe_name=None)</td></tr>
<tr class="separator:a536e5e7ca863d8dbc6a7a4a465064ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08c4d26f0680f051fa4c9e9b41423191"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classespcoredump_1_1ESPCoreDumpLoader.html#a08c4d26f0680f051fa4c9e9b41423191">_extract_bin_corefile</a> (self, core_fname=None, rom_elf=None, off=0)</td></tr>
<tr class="separator:a08c4d26f0680f051fa4c9e9b41423191"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Core dump loader base class
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00564">564</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0bc5bd2a670eaebd0e1e48387d672fa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bc5bd2a670eaebd0e1e48387d672fa9">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Base constructor for core dump loader
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00593">593</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keyword">def </span>__init__(self):</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Base constructor for core dump loader</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        self.fcore = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        self.hdr = {}</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a08c4d26f0680f051fa4c9e9b41423191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08c4d26f0680f051fa4c9e9b41423191">&#9670;&nbsp;</a></span>_extract_bin_corefile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader._extract_bin_corefile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>core_fname</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rom_elf</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>off</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Creates core dump ELF file
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00768">768</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keyword">def </span>_extract_bin_corefile(self, core_fname=None, rom_elf=None, off=0):</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Creates core dump ELF file</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        core_off = off</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keyword">with</span> open(core_fname, <span class="stringliteral">&#39;w+b&#39;</span>) <span class="keyword">as</span> fce:</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            tcbsz_aligned = self.hdr[<span class="stringliteral">&#39;tcbsz&#39;</span>]</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">if</span> tcbsz_aligned % 4:</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                tcbsz_aligned = 4 * (old_div(tcbsz_aligned,4) + 1)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            core_elf = ESPCoreDumpElfFile()</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            notes = b<span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            core_dump_info_notes = b<span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            task_info_notes = b<span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            task_status = EspCoreDumpTaskStatus()</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.hdr[<span class="stringliteral">&#39;task_num&#39;</span>]):</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                task_status.task_index = i</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                task_status.task_flags = EspCoreDumpTaskStatus.TASK_STATUS_CORRECT</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                data = self.read_data(core_off, self.ESP32_COREDUMP_TSK_HDR_SZ)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                tcb_addr,stack_top,stack_end = struct.unpack_from(self.ESP32_COREDUMP_TSK_HDR_FMT, data)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="keywordflow">if</span> stack_end &gt; stack_top:</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    stack_len = stack_end - stack_top</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    stack_base = stack_top</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                    stack_len = stack_top - stack_end</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    stack_base = stack_end</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                stack_len_aligned = stack_len</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keywordflow">if</span> stack_len_aligned % 4:</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    stack_len_aligned = 4 * (old_div(stack_len_aligned,4) + 1)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                core_off += self.ESP32_COREDUMP_TSK_HDR_SZ</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                logging.debug(<span class="stringliteral">&quot;Read TCB %d bytes @ 0x%x&quot;</span> % (tcbsz_aligned, tcb_addr))</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                data = self.read_data(core_off, tcbsz_aligned)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                task_status.task_tcb_addr = tcb_addr</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    <span class="keywordflow">if</span> self.tcb_is_sane(tcb_addr, tcbsz_aligned):</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                        <span class="keywordflow">if</span> self.hdr[<span class="stringliteral">&#39;tcbsz&#39;</span>] != tcbsz_aligned:</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                            core_elf.add_program_segment(tcb_addr, data[:self.hdr[<span class="stringliteral">&#39;tcbsz&#39;</span>] - tcbsz_aligned],</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                         ESPCoreDumpElfFile.PT_LOAD, ESPCoreDumpSegment.PF_R | ESPCoreDumpSegment.PF_W)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            core_elf.add_program_segment(tcb_addr, data, ESPCoreDumpElfFile.PT_LOAD, ESPCoreDumpSegment.PF_R | ESPCoreDumpSegment.PF_W)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                        <span class="comment"># task_status.task_name = bytearray(&quot;%s\0&quot; % task_name_str, encoding=&#39;ascii&#39;)</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                    <span class="keywordflow">elif</span> tcb_addr <span class="keywordflow">and</span> self.addr_is_fake(tcb_addr):</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        task_status.task_flags |= EspCoreDumpTaskStatus.TASK_STATUS_TCB_CORRUPTED</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    logging.warning(<span class="stringliteral">&quot;Skip TCB %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (tcbsz_aligned, tcb_addr, e))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                core_off += tcbsz_aligned</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                logging.debug(<span class="stringliteral">&quot;Read stack %d bytes @ 0x%x&quot;</span> % (stack_len_aligned, stack_base))</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                data = self.read_data(core_off, stack_len_aligned)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="keywordflow">if</span> stack_len != stack_len_aligned:</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    data = data[:stack_len - stack_len_aligned]</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                task_status.task_stack_start = stack_base</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                task_status.task_stack_len = stack_len_aligned</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    <span class="keywordflow">if</span> self.stack_is_sane(stack_base):</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        core_elf.add_program_segment(stack_base, data, ESPCoreDumpElfFile.PT_LOAD, ESPCoreDumpSegment.PF_R | ESPCoreDumpSegment.PF_W)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    <span class="keywordflow">elif</span> stack_base <span class="keywordflow">and</span> self.addr_is_fake(stack_base):</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                        task_status.task_flags |= EspCoreDumpTaskStatus.TASK_STATUS_STACK_CORRUPTED</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                        core_elf.add_program_segment(stack_base, data, ESPCoreDumpElfFile.PT_LOAD, ESPCoreDumpSegment.PF_R | ESPCoreDumpSegment.PF_W)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    logging.warning(<span class="stringliteral">&quot;Skip task&#39;s (%x) stack %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (tcb_addr, stack_len_aligned, stack_base, e))</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                core_off += stack_len_aligned</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    logging.debug(<span class="stringliteral">&quot;Stack start_end: 0x%x @ 0x%x&quot;</span> % (stack_top, stack_end))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    task_regs,extra_regs = self._get_registers_from_stack(data, stack_end &gt; stack_top)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    logging.error(e)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                task_info_notes += Elf32NoteDesc(<span class="stringliteral">&quot;TASK_INFO&quot;</span>, self.ESP_CORE_DUMP_TASK_INFO_TYPE, task_status.dump()).dump()</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                prstatus = XtensaPrStatus()</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                prstatus.pr_cursig = 0  <span class="comment"># TODO: set sig only for current/failed task</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                prstatus.pr_pid = tcb_addr</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                note = Elf32NoteDesc(<span class="stringliteral">&quot;CORE&quot;</span>, 1, prstatus.dump() + struct.pack(<span class="stringliteral">&quot;&lt;%dL&quot;</span> % len(task_regs), *task_regs)).dump()</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                notes += note</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordflow">if</span> ESPCoreDumpElfFile.REG_EXCCAUSE_IDX <span class="keywordflow">in</span> extra_regs <span class="keywordflow">and</span> len(core_dump_info_notes) == 0:</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    <span class="comment"># actually there will be only one such note - for crashed task</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    core_dump_info_notes += Elf32NoteDesc(<span class="stringliteral">&quot;ESP_CORE_DUMP_INFO&quot;</span>, self.ESP_CORE_DUMP_INFO_TYPE, struct.pack(<span class="stringliteral">&quot;&lt;L&quot;</span>, self.hdr[<span class="stringliteral">&#39;ver&#39;</span>])).dump()</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    exc_regs = []</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    <span class="keywordflow">for</span> reg_id <span class="keywordflow">in</span> extra_regs:</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                        exc_regs.extend([reg_id, extra_regs[reg_id]])</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    core_dump_info_notes += Elf32NoteDesc(<span class="stringliteral">&quot;EXTRA_INFO&quot;</span>, self.ESP_CORE_DUMP_EXTRA_INFO_TYPE,</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                                          struct.pack(<span class="stringliteral">&quot;&lt;%dL&quot;</span> % (1 + len(exc_regs)), tcb_addr, *exc_regs)).dump()</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <span class="keywordflow">if</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_BIN_V2:</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(self.hdr[<span class="stringliteral">&#39;segs_num&#39;</span>]):</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    data = self.read_data(core_off, self.ESP32_COREDUMP_MEM_SEG_HDR_SZ)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    core_off += self.ESP32_COREDUMP_MEM_SEG_HDR_SZ</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    mem_start,mem_sz = struct.unpack_from(self.ESP32_COREDUMP_MEM_SEG_HDR_FMT, data)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    logging.debug(<span class="stringliteral">&quot;Read memory segment %d bytes @ 0x%x&quot;</span> % (mem_sz, mem_start))</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    data = self.read_data(core_off, stack_len_aligned)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                    core_elf.add_program_segment(mem_start, data, ESPCoreDumpElfFile.PT_LOAD, ESPCoreDumpSegment.PF_R | ESPCoreDumpSegment.PF_W)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    core_off += mem_sz</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            <span class="comment"># add notes</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                core_elf.add_aux_segment(notes, ESPCoreDumpElfFile.PT_NOTE, 0)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                logging.warning(<span class="stringliteral">&quot;Skip NOTES segment %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (len(notes), 0, e))</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="comment"># add core dump info notes</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                core_elf.add_aux_segment(core_dump_info_notes, ESPCoreDumpElfFile.PT_NOTE, 0)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                logging.warning(<span class="stringliteral">&quot;Skip core dump info NOTES segment %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (len(core_dump_info_notes), 0, e))</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                core_elf.add_aux_segment(task_info_notes, ESPCoreDumpElfFile.PT_NOTE, 0)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                logging.warning(<span class="stringliteral">&quot;Skip failed tasks info NOTES segment %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (len(task_info_notes), 0, e))</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="comment"># add ROM text sections</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">if</span> rom_elf:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">for</span> ps <span class="keywordflow">in</span> rom_elf.program_segments:</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                    <span class="keywordflow">if</span> (ps.flags &amp; ESPCoreDumpSegment.PF_X) == 0:</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                        core_elf.add_program_segment(ps.addr, ps.data, ESPCoreDumpElfFile.PT_LOAD, ps.flags)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                    <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        logging.warning(<span class="stringliteral">&quot;Skip ROM segment %d bytes @ 0x%x. (Reason: %s)&quot;</span> % (len(ps.data), ps.addr, e))</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="comment"># dump core ELF</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            core_elf.e_type = ESPCoreDumpElfFile.ET_CORE</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            core_elf.e_machine = ESPCoreDumpElfFile.EM_XTENSA</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            core_elf.dump(fce)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">return</span> core_fname</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a536e5e7ca863d8dbc6a7a4a465064ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536e5e7ca863d8dbc6a7a4a465064ac3">&#9670;&nbsp;</a></span>_extract_elf_corefile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader._extract_elf_corefile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>core_fname</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>off</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exe_name</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> Reads the ELF formatted core dump image and parse it
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00727">727</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">def </span>_extract_elf_corefile(self, core_fname=None, off=0, exe_name=None):</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="stringliteral">&quot;&quot;&quot; Reads the ELF formatted core dump image and parse it</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        core_off = off</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">if</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_ELF_CRC32:</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            checksum_len = self.ESP32_COREDUMP_CRC_SZ</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">elif</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_ELF_SHA256:</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            checksum_len = self.ESP32_COREDUMP_SHA256_SZ</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">raise</span> ESPCoreDumpLoaderError(<span class="stringliteral">&quot;Core dump version &#39;%d&#39; is not supported!&quot;</span> % self.hdr[<span class="stringliteral">&#39;ver&#39;</span>])</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        core_elf = ESPCoreDumpElfFile()</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        data = self.read_data(core_off, self.hdr[<span class="stringliteral">&#39;tot_len&#39;</span>] - checksum_len - self.ESP32_COREDUMP_HDR_SZ)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keyword">with</span> open(core_fname, <span class="stringliteral">&#39;w+b&#39;</span>) <span class="keyword">as</span> fce:</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                fce.write(data)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                fce.flush()</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                fce.seek(0)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                core_elf._read_elf_file(fce)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="keywordflow">if</span> exe_name:</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    exe_elf = ESPCoreDumpElfFile(exe_name)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment"># Read note segments from core file which are belong to tasks (TCB or stack)</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="keywordflow">for</span> ns <span class="keywordflow">in</span> core_elf.aux_segments:</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="keywordflow">if</span> ns.type != ESPCoreDumpElfFile.PT_NOTE:</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                        <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                    note_read = 0</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                    <span class="keywordflow">while</span> note_read &lt; len(ns.data):</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        note = Elf32NoteDesc(<span class="stringliteral">&quot;&quot;</span>, 0, <span class="keywordtype">None</span>)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                        note_read += note.read(ns.data[note_read:])</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                        <span class="comment"># Check for version info note</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        <span class="keywordflow">if</span> <span class="stringliteral">&#39;ESP_CORE_DUMP_INFO&#39;</span> == note.name <span class="keywordflow">and</span> note.type == self.ESP_CORE_DUMP_INFO_TYPE <span class="keywordflow">and</span> exe_name:</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                            app_sha256 = binascii.hexlify(exe_elf.sha256())</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                            n_ver_len = struct.calcsize(<span class="stringliteral">&quot;&lt;L&quot;</span>)</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                            n_sha256_len = self.ESP32_COREDUMP_SHA256_SZ * 2  <span class="comment"># SHA256 as hex string</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                            n_ver,coredump_sha256 = struct.unpack(<span class="stringliteral">&quot;&lt;L%ds&quot;</span> % (n_sha256_len), note.desc[:n_ver_len + n_sha256_len])</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                            <span class="keywordflow">if</span> coredump_sha256 != app_sha256 <span class="keywordflow">or</span> n_ver != self.hdr[<span class="stringliteral">&#39;ver&#39;</span>]:</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                <span class="keywordflow">raise</span> ESPCoreDumpError(<span class="stringliteral">&quot;Invalid application image for coredump: app_SHA256(%s) != coredump_SHA256(%s).&quot;</span> %</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                                       (app_sha256, coredump_sha256))</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keywordflow">except</span> ESPCoreDumpError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                logging.warning(<span class="stringliteral">&quot;Failed to extract ELF core dump image into file %s. (Reason: %s)&quot;</span> % (core_fname, e))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">return</span> core_fname</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a65bbc5b449ecd26a55c854df72e36186"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65bbc5b449ecd26a55c854df72e36186">&#9670;&nbsp;</a></span>_get_registers_from_stack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader._get_registers_from_stack </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grows_down</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns list of registers (in GDB format) from xtensa stack frame
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00599">599</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keyword">def </span>_get_registers_from_stack(self, data, grows_down):</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns list of registers (in GDB format) from xtensa stack frame</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="comment"># from &quot;gdb/xtensa-tdep.h&quot;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment"># typedef struct</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment"># {</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment"># 0    xtensa_elf_greg_t pc;</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment"># 1    xtensa_elf_greg_t ps;</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment"># 2    xtensa_elf_greg_t lbeg;</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment"># 3    xtensa_elf_greg_t lend;</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment"># 4    xtensa_elf_greg_t lcount;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment"># 5    xtensa_elf_greg_t sar;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment"># 6    xtensa_elf_greg_t windowstart;</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment"># 7    xtensa_elf_greg_t windowbase;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment"># 8..63 xtensa_elf_greg_t reserved[8+48];</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment"># 64   xtensa_elf_greg_t ar[64];</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment"># } xtensa_elf_gregset_t;</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        REG_PC_IDX = 0</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        REG_PS_IDX = 1</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        REG_LB_IDX = 2</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        REG_LE_IDX = 3</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        REG_LC_IDX = 4</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        REG_SAR_IDX = 5</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment"># REG_WS_IDX = 6</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment"># REG_WB_IDX = 7</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        REG_AR_START_IDX = 64</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment"># REG_AR_NUM = 64</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="comment"># FIXME: acc to xtensa_elf_gregset_t number of regs must be 128,</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment"># but gdb complanis when it less then 129</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        REG_NUM = 129</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="comment"># XT_SOL_EXIT = 0</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        XT_SOL_PC = 1</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        XT_SOL_PS = 2</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment"># XT_SOL_NEXT = 3</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        XT_SOL_AR_START = 4</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        XT_SOL_AR_NUM = 4</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment"># XT_SOL_FRMSZ = 8</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        XT_STK_EXIT = 0</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        XT_STK_PC = 1</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        XT_STK_PS = 2</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        XT_STK_AR_START = 3</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        XT_STK_AR_NUM = 16</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        XT_STK_SAR = 19</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        XT_STK_EXCCAUSE = 20</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        XT_STK_EXCVADDR = 21</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        XT_STK_LBEG = 22</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        XT_STK_LEND = 23</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        XT_STK_LCOUNT = 24</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        XT_STK_FRMSZ = 25</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        extra_regs = {ESPCoreDumpElfFile.REG_EPS2_IDX: 0, ESPCoreDumpElfFile.REG_EPS3_IDX: 0,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                      ESPCoreDumpElfFile.REG_EPS4_IDX: 0, ESPCoreDumpElfFile.REG_EPS5_IDX: 0,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                      ESPCoreDumpElfFile.REG_EPS6_IDX: 0, ESPCoreDumpElfFile.REG_EPS7_IDX: 0,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                      ESPCoreDumpElfFile.REG_EPC1_IDX: 0, ESPCoreDumpElfFile.REG_EPC2_IDX: 0,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                      ESPCoreDumpElfFile.REG_EPC3_IDX: 0, ESPCoreDumpElfFile.REG_EPC4_IDX: 0,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                      ESPCoreDumpElfFile.REG_EPC5_IDX: 0, ESPCoreDumpElfFile.REG_EPC6_IDX: 0,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                      ESPCoreDumpElfFile.REG_EPC7_IDX: 0}</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        regs = [0] * REG_NUM</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment"># TODO: support for growing up stacks</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> grows_down:</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">raise</span> ESPCoreDumpLoaderError(<span class="stringliteral">&quot;Growing up stacks are not supported for now!&quot;</span>)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        ex_struct = <span class="stringliteral">&quot;&lt;%dL&quot;</span> % XT_STK_FRMSZ</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">if</span> len(data) &lt; struct.calcsize(ex_struct):</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">raise</span> ESPCoreDumpLoaderError(<span class="stringliteral">&quot;Too small stack to keep frame: %d bytes!&quot;</span> % len(data))</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        stack = struct.unpack(ex_struct, data[:struct.calcsize(ex_struct)])</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="comment"># Stack frame type indicator is always the first item</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        rc = stack[XT_STK_EXIT]</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">if</span> rc != 0:</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            regs[REG_PC_IDX] = stack[XT_STK_PC]</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            regs[REG_PS_IDX] = stack[XT_STK_PS]</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(XT_STK_AR_NUM):</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                regs[REG_AR_START_IDX + i] = stack[XT_STK_AR_START + i]</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            regs[REG_SAR_IDX] = stack[XT_STK_SAR]</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            regs[REG_LB_IDX] = stack[XT_STK_LBEG]</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            regs[REG_LE_IDX] = stack[XT_STK_LEND]</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            regs[REG_LC_IDX] = stack[XT_STK_LCOUNT]</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="comment"># FIXME: crashed and some running tasks (e.g. prvIdleTask) have EXCM bit set</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment"># and GDB can not unwind callstack properly (it implies not windowed call0)</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">if</span> regs[REG_PS_IDX] &amp; (1 &lt;&lt; 5):</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                regs[REG_PS_IDX] &amp;= ~(1 &lt;&lt; 4)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> stack[XT_STK_EXCCAUSE] <span class="keywordflow">in</span> xtensa_exception_cause_dict:</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                extra_regs[ESPCoreDumpElfFile.REG_EXCCAUSE_IDX] = stack[XT_STK_EXCCAUSE]</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                extra_regs[ESPCoreDumpElfFile.REG_EXCCAUSE_IDX] = INVALID_CAUSE_VALUE</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            extra_regs[ESPCoreDumpElfFile.REG_EXCVADDR_IDX] = stack[XT_STK_EXCVADDR]</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            regs[REG_PC_IDX] = stack[XT_SOL_PC]</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            regs[REG_PS_IDX] = stack[XT_SOL_PS]</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(XT_SOL_AR_NUM):</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                regs[REG_AR_START_IDX + i] = stack[XT_SOL_AR_START + i]</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="comment"># nxt = stack[XT_SOL_NEXT]</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keywordflow">return</span> regs,extra_regs</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2178c23df91d8eb2d469af9cd583644e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2178c23df91d8eb2d469af9cd583644e">&#9670;&nbsp;</a></span>addr_is_fake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.addr_is_fake </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check if address is in fake area
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00705">705</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">def </span>addr_is_fake(self, addr):</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Check if address is in fake area</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> ((addr &lt; 0x3f3fffff <span class="keywordflow">and</span> addr &gt;= 0x20000000) <span class="keywordflow">or</span> addr &gt;= 0x80000000)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e2fc97010dcceb5bf20e462c2c2174f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e2fc97010dcceb5bf20e462c2c2174f">&#9670;&nbsp;</a></span>cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.cleanup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Cleans up loader resources
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00719">719</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keyword">def </span>cleanup(self):</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Cleans up loader resources</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">if</span> self.fcore:</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            self.fcore.close()</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">if</span> self.fcore_name:</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                self.remove_tmp_file(self.fcore_name)</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="afca16b7ad4d1431b9467403991a48a10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca16b7ad4d1431b9467403991a48a10">&#9670;&nbsp;</a></span>create_corefile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.create_corefile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>core_fname</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exe_name</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rom_elf</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>off</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Creates core dump ELF file
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00887">887</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keyword">def </span>create_corefile(self, core_fname=None, exe_name=None, rom_elf=None, off=0):</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Creates core dump ELF file</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        data = self.read_data(off, self.ESP32_COREDUMP_HDR_SZ)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        vals = struct.unpack_from(self.ESP32_COREDUMP_HDR_FMT, data)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        self.hdr = dict(zip((<span class="stringliteral">&#39;tot_len&#39;</span>, <span class="stringliteral">&#39;ver&#39;</span>, <span class="stringliteral">&#39;task_num&#39;</span>, <span class="stringliteral">&#39;tcbsz&#39;</span>, <span class="stringliteral">&#39;segs_num&#39;</span>), vals))</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> core_fname:</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            fce = tempfile.NamedTemporaryFile(mode=<span class="stringliteral">&#39;w+b&#39;</span>, delete=<span class="keyword">False</span>)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            core_fname = fce.name</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">if</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_ELF_CRC32 <span class="keywordflow">or</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_ELF_SHA256:</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordflow">return</span> self._extract_elf_corefile(core_fname, off + self.ESP32_COREDUMP_HDR_SZ, exe_name)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">elif</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_BIN_V2:</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">return</span> self._extract_bin_corefile(core_fname, rom_elf, off + self.ESP32_COREDUMP_HDR_SZ)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">elif</span> self.hdr[<span class="stringliteral">&#39;ver&#39;</span>] == self.ESP32_COREDUMP_VERSION_BIN_V1:</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">return</span> self._extract_bin_corefile(core_fname, rom_elf, off + self.ESP32_COREDUMP_BIN_V1_HDR_SZ)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">raise</span> ESPCoreDumpLoaderError(<span class="stringliteral">&quot;Core dump version &#39;0x%x&#39; is not supported!&quot;</span> % (self.hdr[<span class="stringliteral">&#39;ver&#39;</span>]))</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1bca0f2bcf203dc9b6707ed2054f3920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bca0f2bcf203dc9b6707ed2054f3920">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.read_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reads data from raw core dump got from flash or UART
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00904">904</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keyword">def </span>read_data(self, off, sz):</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Reads data from raw core dump got from flash or UART</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        self.fcore.seek(off)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        data = self.fcore.read(sz)</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">return</span> data</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a94c03e2dd86a5d13f8698d2290abee4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c03e2dd86a5d13f8698d2290abee4f">&#9670;&nbsp;</a></span>remove_tmp_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.remove_tmp_file </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Silently removes temporary file
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00710">710</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keyword">def </span>remove_tmp_file(self, fname):</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Silently removes temporary file</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            os.remove(fname)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">except</span> OSError <span class="keyword">as</span> e:</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">if</span> e.errno != errno.ENOENT:</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                logging.warning(<span class="stringliteral">&quot;Failed to remove temp file &#39;%s&#39; (%d)!&quot;</span> % (fname, e.errno))</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fba2fe6ef576478482de8d1fff74978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fba2fe6ef576478482de8d1fff74978">&#9670;&nbsp;</a></span>stack_is_sane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.stack_is_sane </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check stack address if it is correct
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00700">700</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keyword">def </span>stack_is_sane(self, sp):</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Check stack address if it is correct</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">return</span> not(sp &lt; 0x3ffae010 <span class="keywordflow">or</span> sp &gt; 0x3fffffff)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9eb99313732885107fa9ca12bbae172a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9eb99313732885107fa9ca12bbae172a">&#9670;&nbsp;</a></span>tcb_is_sane()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def espcoredump.ESPCoreDumpLoader.tcb_is_sane </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tcb_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tcb_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check tcb address if it is correct
</pre> 
<p class="definition">Definition at line <a class="el" href="espcoredump_8py_source.html#l00695">695</a> of file <a class="el" href="espcoredump_8py_source.html">espcoredump.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">def </span>tcb_is_sane(self, tcb_addr, tcb_size):</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Check tcb address if it is correct</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">return</span> <span class="keywordflow">not</span> (tcb_addr &lt; 0x3ffae000 <span class="keywordflow">or</span> (tcb_addr + tcb_size) &gt; 0x40000000)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="espcoredump_8py_source.html">espcoredump.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
