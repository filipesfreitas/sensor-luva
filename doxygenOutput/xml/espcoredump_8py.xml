<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.2" xml:lang="en-US">
  <compounddef id="espcoredump_8py" kind="file" language="Python">
    <compoundname>espcoredump.py</compoundname>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpError" prot="public">espcoredump::ESPCoreDumpError</innerclass>
    <innerclass refid="classespcoredump_1_1BinStruct" prot="public">espcoredump::BinStruct</innerclass>
    <innerclass refid="classespcoredump_1_1Elf32FileHeader" prot="public">espcoredump::Elf32FileHeader</innerclass>
    <innerclass refid="classespcoredump_1_1Elf32ProgramHeader" prot="public">espcoredump::Elf32ProgramHeader</innerclass>
    <innerclass refid="classespcoredump_1_1Elf32NoteDesc" prot="public">espcoredump::Elf32NoteDesc</innerclass>
    <innerclass refid="classespcoredump_1_1XtensaPrStatus" prot="public">espcoredump::XtensaPrStatus</innerclass>
    <innerclass refid="classespcoredump_1_1EspCoreDumpTaskStatus" prot="public">espcoredump::EspCoreDumpTaskStatus</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpSegment" prot="public">espcoredump::ESPCoreDumpSegment</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpSection" prot="public">espcoredump::ESPCoreDumpSection</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpElfFile" prot="public">espcoredump::ESPCoreDumpElfFile</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpLoaderError" prot="public">espcoredump::ESPCoreDumpLoaderError</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpLoader" prot="public">espcoredump::ESPCoreDumpLoader</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpFileLoader" prot="public">espcoredump::ESPCoreDumpFileLoader</innerclass>
    <innerclass refid="classespcoredump_1_1ESPCoreDumpFlashLoader" prot="public">espcoredump::ESPCoreDumpFlashLoader</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIOutRecordHandler" prot="public">espcoredump::GDBMIOutRecordHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIOutStreamHandler" prot="public">espcoredump::GDBMIOutStreamHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIResultHandler" prot="public">espcoredump::GDBMIResultHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIThreadListIdsHandler" prot="public">espcoredump::GDBMIThreadListIdsHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIThreadSelectHandler" prot="public">espcoredump::GDBMIThreadSelectHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIThreadInfoHandler" prot="public">espcoredump::GDBMIThreadInfoHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIDataEvalHandler" prot="public">espcoredump::GDBMIDataEvalHandler</innerclass>
    <innerclass refid="classespcoredump_1_1GDBMIStreamConsoleHandler" prot="public">espcoredump::GDBMIStreamConsoleHandler</innerclass>
    <innernamespace refid="namespaceespcoredump">espcoredump</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">#!/usr/bin/env<sp/>python</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ESP32<sp/>core<sp/>dump<sp/>Utility</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>print_function</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>unicode_literals</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>division</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>hashlib<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sha256</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sys</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>zip</highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>str</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>range</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>past.utils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>old_div</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>builtins<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>object</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;Import<sp/>has<sp/>failed<sp/>probably<sp/>because<sp/>of<sp/>the<sp/>missing<sp/>&quot;future&quot;<sp/>package.<sp/>Please<sp/>install<sp/>all<sp/>the<sp/>packages<sp/>for<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;interpreter<sp/>{}<sp/>from<sp/>the<sp/>$IDF_PATH/requirements.txt<sp/>file.&apos;</highlight><highlight class="normal">.format(sys.executable))</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/>sys.exit(1)</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>argparse</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>subprocess</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>tempfile</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>struct</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>errno</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>base64</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>binascii</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logging</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal">idf_path<sp/>=<sp/>os.getenv(</highlight><highlight class="stringliteral">&apos;IDF_PATH&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>idf_path:</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/>sys.path.insert(0,<sp/>os.path.join(idf_path,<sp/></highlight><highlight class="stringliteral">&apos;components&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;esptool_py&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;esptool&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>esptool</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ImportError:</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;esptool<sp/>is<sp/>not<sp/>found!<sp/>Set<sp/>proper<sp/>$IDF_PATH<sp/>in<sp/>environment.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/>sys.exit(2)</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal">__version__<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;0.4-dev&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>os.name<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;nt&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/>CLOSE_FDS<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>CLOSE_FDS<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal">INVALID_CAUSE_VALUE<sp/>=<sp/>0xFFFF</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Exception<sp/>cause<sp/>dictionary<sp/>to<sp/>get<sp/>translation<sp/>of<sp/>exccause<sp/>register</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="comment">#<sp/>From<sp/>4.4.1.5<sp/>table<sp/>4-64<sp/>Exception<sp/>Causes<sp/>of<sp/>Xtensa</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Instruction<sp/>Set<sp/>Architecture<sp/>(ISA)<sp/>Reference<sp/>Manual</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal">xtensa_exception_cause_dict<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>0:<sp/>(</highlight><highlight class="stringliteral">&quot;IllegalInstructionCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Illegal<sp/>instruction&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>1:<sp/>(</highlight><highlight class="stringliteral">&quot;SyscallCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;SYSCALL<sp/>instruction&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>2:<sp/>(</highlight><highlight class="stringliteral">&quot;InstructionFetchErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Processor<sp/>internal<sp/>physical<sp/>address<sp/>or<sp/>data<sp/>error<sp/>during<sp/>instruction<sp/>fetch.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>3:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStoreErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Processor<sp/>internal<sp/>physical<sp/>address<sp/>or<sp/>data<sp/>error<sp/>during<sp/>load<sp/>or<sp/>store.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>4:<sp/>(</highlight><highlight class="stringliteral">&quot;Level1InterruptCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Level-1<sp/>interrupt<sp/>as<sp/>indicated<sp/>by<sp/>set<sp/>level-1<sp/>bits<sp/>in<sp/>the<sp/>INTERRUPT<sp/>register&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>5:<sp/>(</highlight><highlight class="stringliteral">&quot;AllocaCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;MOVSP<sp/>instruction,<sp/>if<sp/>caller`s<sp/>registers<sp/>are<sp/>not<sp/>in<sp/>the<sp/>register<sp/>file&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>6:<sp/>(</highlight><highlight class="stringliteral">&quot;IntegerDivideByZeroCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;QUOS:<sp/>QUOU,<sp/>REMS:<sp/>or<sp/>REMU<sp/>divisor<sp/>operand<sp/>is<sp/>zero&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>8:<sp/>(</highlight><highlight class="stringliteral">&quot;PrivilegedCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Attempt<sp/>to<sp/>execute<sp/>a<sp/>privileged<sp/>operation<sp/>when<sp/>CRING<sp/>?<sp/>0&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>9:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStoreAlignmentCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Load<sp/>or<sp/>store<sp/>to<sp/>an<sp/>unaligned<sp/>address.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>12:<sp/>(</highlight><highlight class="stringliteral">&quot;InstrPIFDataErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;PIF<sp/>data<sp/>error<sp/>during<sp/>instruction<sp/>fetch.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>13:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStorePIFDataErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Synchronous<sp/>PIF<sp/>data<sp/>error<sp/>during<sp/>LoadStore<sp/>access.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>14:<sp/>(</highlight><highlight class="stringliteral">&quot;InstrPIFAddrErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;PIF<sp/>address<sp/>error<sp/>during<sp/>instruction<sp/>fetch.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>15:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStorePIFAddrErrorCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Synchronous<sp/>PIF<sp/>address<sp/>error<sp/>during<sp/>LoadStore<sp/>access.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>16:<sp/>(</highlight><highlight class="stringliteral">&quot;InstTLBMissCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>during<sp/>Instruction<sp/>TLB<sp/>refill.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>17:<sp/>(</highlight><highlight class="stringliteral">&quot;InstTLBMultiHitCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Multiple<sp/>instruction<sp/>TLB<sp/>entries<sp/>matched.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>18:<sp/>(</highlight><highlight class="stringliteral">&quot;InstFetchPrivilegeCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;An<sp/>instruction<sp/>fetch<sp/>referenced<sp/>a<sp/>virtual<sp/>address<sp/>at<sp/>a<sp/>ring<sp/>level<sp/>less<sp/>than<sp/>CRING.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>20:<sp/>(</highlight><highlight class="stringliteral">&quot;InstFetchProhibitedCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;An<sp/>instruction<sp/>fetch<sp/>referenced<sp/>a<sp/>page<sp/>mapped<sp/>with<sp/>an<sp/>attribute<sp/>that<sp/>does<sp/>not<sp/>permit<sp/>instruction<sp/>fetch<sp/>(EXCVADDR).&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>24:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStoreTLBMissCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Error<sp/>during<sp/>TLB<sp/>refill<sp/>for<sp/>a<sp/>load<sp/>or<sp/>store.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>25:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStoreTLBMultiHitCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Multiple<sp/>TLB<sp/>entries<sp/>matched<sp/>for<sp/>a<sp/>load<sp/>or<sp/>store.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>26:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadStorePrivilegeCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;A<sp/>load<sp/>or<sp/>store<sp/>referenced<sp/>a<sp/>virtual<sp/>address<sp/>at<sp/>a<sp/>ring<sp/>level<sp/>less<sp/>than<sp/>CRING.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>28:<sp/>(</highlight><highlight class="stringliteral">&quot;LoadProhibitedCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;A<sp/>load<sp/>referenced<sp/>a<sp/>page<sp/>mapped<sp/>with<sp/>an<sp/>attribute<sp/>that<sp/>does<sp/>not<sp/>permit<sp/>loads.<sp/>(See<sp/>EXCVADDR<sp/>for<sp/>more<sp/>information)&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/>29:<sp/>(</highlight><highlight class="stringliteral">&quot;StoreProhibitedCause&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;A<sp/>store<sp/>referenced<sp/>a<sp/>page<sp/>mapped<sp/>with<sp/>an<sp/>attribute<sp/>that<sp/>does<sp/>not<sp/>permit<sp/>stores<sp/>[Region<sp/>Protection<sp/>Option<sp/>or<sp/>MMU<sp/>Option].&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>32:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor0Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>0<sp/>instruction<sp/>when<sp/>cp0<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/>33:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor1Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>1<sp/>instruction<sp/>when<sp/>cp1<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>34:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor2Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>2<sp/>instruction<sp/>when<sp/>cp2<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>35:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor3Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>3<sp/>instruction<sp/>when<sp/>cp3<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>36:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor4Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>4<sp/>instruction<sp/>when<sp/>cp4<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/>37:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor5Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>5<sp/>instruction<sp/>when<sp/>cp5<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/>38:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor6Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>6<sp/>instruction<sp/>when<sp/>cp6<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/>39:<sp/>(</highlight><highlight class="stringliteral">&quot;Coprocessor7Disabled&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Coprocessor<sp/>7<sp/>instruction<sp/>when<sp/>cp7<sp/>disabled&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>INVALID_CAUSE_VALUE:<sp/>(</highlight><highlight class="stringliteral">&quot;InvalidCauseRegister&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>EXCCAUSE<sp/>register<sp/>value<sp/>or<sp/>current<sp/>task<sp/>is<sp/>broken<sp/>and<sp/>was<sp/>skipped&quot;</highlight><highlight class="normal">)}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88" refid="classespcoredump_1_1ESPCoreDumpError" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(RuntimeError):</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>runtime<sp/>error<sp/>class</highlight></codeline>
<codeline lineno="90"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="classespcoredump_1_1ESPCoreDumpError_1a5f1f7f6a541297845a1ba24b0760bddf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpError_1a5f1f7f6a541297845a1ba24b0760bddf" kindref="member">__init__</ref>(self,<sp/>message):</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>core<sp/>dump<sp/>error</highlight></codeline>
<codeline lineno="93"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpError,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpError_1a5f1f7f6a541297845a1ba24b0760bddf" kindref="member">__init__</ref>(message)</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97" refid="classespcoredump_1_1BinStruct" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1BinStruct" kindref="compound">BinStruct</ref>(object):</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Binary<sp/>structure<sp/>representation</highlight></codeline>
<codeline lineno="99"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Subclasses<sp/>must<sp/>specify<sp/>actual<sp/>structure<sp/>layout<sp/>using<sp/>&apos;fields&apos;<sp/>and<sp/>&apos;format&apos;<sp/>members.</highlight></codeline>
<codeline lineno="101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>For<sp/>example,<sp/>the<sp/>following<sp/>subclass<sp/>represents<sp/>structure<sp/>with<sp/>two<sp/>fields:</highlight></codeline>
<codeline lineno="102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f1<sp/>of<sp/>size<sp/>2<sp/>bytes<sp/>and<sp/>4<sp/>bytes<sp/>f2.<sp/>Little<sp/>endian.</highlight></codeline>
<codeline lineno="103"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>class<sp/>SomeStruct(BinStruct):</highlight></codeline>
<codeline lineno="104"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>(&quot;f1&quot;,</highlight></codeline>
<codeline lineno="105"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;f2&quot;)</highlight></codeline>
<codeline lineno="106"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>format<sp/>=<sp/>&quot;&lt;HL&quot;</highlight></codeline>
<codeline lineno="107"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Then<sp/>subclass<sp/>can<sp/>be<sp/>used<sp/>to<sp/>initialize<sp/>fields<sp/>of<sp/>underlaying<sp/>structure<sp/>and<sp/>convert<sp/>it<sp/>to<sp/>binary<sp/>representation:</highlight></codeline>
<codeline lineno="109"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>open(&apos;some_struct.bin&apos;,<sp/>&apos;wb&apos;)</highlight></codeline>
<codeline lineno="110"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>=<sp/>SomeStruct()</highlight></codeline>
<codeline lineno="111"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s.f1<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="112"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s.f2<sp/>=<sp/>10</highlight></codeline>
<codeline lineno="113"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.write(s.dump())</highlight></codeline>
<codeline lineno="114"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.close()</highlight></codeline>
<codeline lineno="115"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117" refid="classespcoredump_1_1BinStruct_1abeec852ef4d40adcb4439a35475d43dd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1BinStruct_1abeec852ef4d40adcb4439a35475d43dd" kindref="member">__init__</ref>(self,<sp/>buf=None):</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Base<sp/>constructor<sp/>for<sp/>binary<sp/>structure<sp/>objects</highlight></codeline>
<codeline lineno="119"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>buf<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;\0&apos;</highlight><highlight class="normal"><sp/>*<sp/>self.<ref refid="classespcoredump_1_1BinStruct_1afdb828b90757437b3768ff8bedab6193" kindref="member">sizeof</ref>sizeof()</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>struct.unpack(self.__class__.format,<sp/>buf[:self.<ref refid="classespcoredump_1_1BinStruct_1afdb828b90757437b3768ff8bedab6193" kindref="member">sizeof</ref>sizeof()])</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.__dict__.update(zip(self.__class__.fields,<sp/>fields))</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="classespcoredump_1_1BinStruct_1afdb828b90757437b3768ff8bedab6193" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1BinStruct_1afdb828b90757437b3768ff8bedab6193" kindref="member">sizeof</ref>(self):</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>the<sp/>size<sp/>of<sp/>the<sp/>structure<sp/>represented<sp/>by<sp/>specific<sp/>subclass</highlight></codeline>
<codeline lineno="127"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>struct.calcsize(self.__class__.format)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"></highlight></codeline>
<codeline lineno="130" refid="classespcoredump_1_1BinStruct_1a93f45e22e0b6034df1025a4998cacc00" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1BinStruct_1a93f45e22e0b6034df1025a4998cacc00" kindref="member">dump</ref>(self):</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>binary<sp/>representation<sp/>of<sp/>structure</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keys<sp/>=<sp/>self.__class__.fields</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>struct.pack(self.__class__.format,<sp/>*(self.__dict__[k]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>keys))</highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="classespcoredump_1_1Elf32FileHeader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32FileHeader" kindref="compound">Elf32FileHeader</ref>(<ref refid="classespcoredump_1_1BinStruct" kindref="compound">BinStruct</ref>):</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;ELF32<sp/>file<sp/>header</highlight></codeline>
<codeline lineno="139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;e_ident&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_type&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_machine&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_version&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_entry&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_phoff&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_shoff&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_flags&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_ehsize&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_phentsize&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_phnum&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_shentsize&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_shnum&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;e_shstrndx&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>format<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;16sHHLLLLLHHHHHH&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight></codeline>
<codeline lineno="156" refid="classespcoredump_1_1Elf32FileHeader_1a33ecb6098e6d541fee71c78c29c4fe42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32FileHeader_1a33ecb6098e6d541fee71c78c29c4fe42" kindref="member">__init__</ref>(self,<sp/>buf=None):</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>ELF32<sp/>file<sp/>header<sp/>structure</highlight></codeline>
<codeline lineno="158"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(Elf32FileHeader,<sp/>self).<ref refid="classespcoredump_1_1Elf32FileHeader_1a33ecb6098e6d541fee71c78c29c4fe42" kindref="member">__init__</ref>(buf)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>buf<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Fill<sp/>in<sp/>sane<sp/>ELF<sp/>header<sp/>for<sp/>LSB32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32FileHeader_1acaab4a1dc2f7755c6277cbb7092be304" kindref="member">e_ident</ref>e_ident<sp/>=<sp/>b</highlight><highlight class="stringliteral">&quot;\x7fELF\1\1\1\0\0\0\0\0\0\0\0\0&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32FileHeader_1a113ba6a900f93f9a3a624d82efdd6443" kindref="member">e_version</ref>e_version<sp/>=<sp/>ESPCoreDumpElfFile.EV_CURRENT</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32FileHeader_1a24fc88e74e42625fb3abc6f842ee5a9e" kindref="member">e_ehsize</ref>e_ehsize<sp/>=<sp/>self.<ref refid="classespcoredump_1_1BinStruct_1afdb828b90757437b3768ff8bedab6193" kindref="member">sizeof</ref>sizeof()</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167" refid="classespcoredump_1_1Elf32ProgramHeader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32ProgramHeader" kindref="compound">Elf32ProgramHeader</ref>(<ref refid="classespcoredump_1_1BinStruct" kindref="compound">BinStruct</ref>):</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;ELF32<sp/>program<sp/>header</highlight></codeline>
<codeline lineno="169"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;p_type&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_offset&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_vaddr&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_paddr&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_filesz&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_memsz&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_flags&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;p_align&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>format<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;LLLLLLLL&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181" refid="classespcoredump_1_1Elf32NoteDesc" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(object):</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;ELF32<sp/>note<sp/>descriptor</highlight></codeline>
<codeline lineno="183"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184" refid="classespcoredump_1_1Elf32NoteDesc_1ac2a6009ee1b2d7bfdf6d25cdeda2e273" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32NoteDesc_1ac2a6009ee1b2d7bfdf6d25cdeda2e273" kindref="member">__init__</ref>(self,<sp/>name,<sp/>type,<sp/>desc):</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>ELF32<sp/>note<sp/>descriptor</highlight></codeline>
<codeline lineno="186"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1a85e8ea0083f0029b4eaca1b5aaf3ddfe" kindref="member">name</ref>name<sp/>=<sp/>name</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1aed80af2d429ef460ea47d73e4e9bc6e7" kindref="member">type</ref>type<sp/>=<sp/>type</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1afa7d221d6651db49f91915160ddba46f" kindref="member">desc</ref>desc<sp/>=<sp/>desc</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191" refid="classespcoredump_1_1Elf32NoteDesc_1a672df2fabed926f96bc0b1690450cef8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32NoteDesc_1a672df2fabed926f96bc0b1690450cef8" kindref="member">dump</ref>(self):</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>binary<sp/>representation<sp/>of<sp/>ELF32<sp/>note<sp/>descriptor</highlight></codeline>
<codeline lineno="193"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nm_buf<sp/>=<sp/>bytearray(self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1a85e8ea0083f0029b4eaca1b5aaf3ddfe" kindref="member">name</ref>name,<sp/>encoding=</highlight><highlight class="stringliteral">&apos;ascii&apos;</highlight><highlight class="normal">)<sp/>+<sp/>b</highlight><highlight class="stringliteral">&apos;\0&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hdr<sp/>=<sp/>struct.pack(</highlight><highlight class="stringliteral">&quot;&lt;LLL&quot;</highlight><highlight class="normal">,<sp/>len(nm_buf),<sp/>len(self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1afa7d221d6651db49f91915160ddba46f" kindref="member">desc</ref>desc),<sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1aed80af2d429ef460ea47d73e4e9bc6e7" kindref="member">type</ref>type)</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pad<sp/>for<sp/>4<sp/>byte<sp/>alignment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>nm_buf<sp/>+<sp/>((4<sp/>-<sp/>len(nm_buf))<sp/>%<sp/>4)<sp/>*<sp/>b</highlight><highlight class="stringliteral">&apos;\0&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desc<sp/>=<sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1afa7d221d6651db49f91915160ddba46f" kindref="member">desc</ref>desc<sp/>+<sp/>((4<sp/>-<sp/>len(self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1afa7d221d6651db49f91915160ddba46f" kindref="member">desc</ref>desc))<sp/>%<sp/>4)<sp/>*<sp/>b</highlight><highlight class="stringliteral">&apos;\0&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hdr<sp/>+<sp/>name<sp/>+<sp/>desc</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="classespcoredump_1_1Elf32NoteDesc_1a5fc28c4a9ed715b2dec34a752b37dc83" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1Elf32NoteDesc_1a5fc28c4a9ed715b2dec34a752b37dc83" kindref="member">read</ref>(self,<sp/>data):</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>ELF32<sp/>note<sp/>descriptor</highlight></codeline>
<codeline lineno="203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hdr_sz<sp/>=<sp/>struct.calcsize(</highlight><highlight class="stringliteral">&quot;&lt;LLL&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nm_len,desc_len,self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1aed80af2d429ef460ea47d73e4e9bc6e7" kindref="member">type</ref>type<sp/>=<sp/>struct.unpack(</highlight><highlight class="stringliteral">&quot;&lt;LLL&quot;</highlight><highlight class="normal">,<sp/>data[:hdr_sz])</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nm_len_a<sp/>=<sp/>nm_len<sp/>+<sp/>((4<sp/>-<sp/>nm_len)<sp/>%<sp/>4)</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1a85e8ea0083f0029b4eaca1b5aaf3ddfe" kindref="member">name</ref>name<sp/>=<sp/>struct.unpack(</highlight><highlight class="stringliteral">&quot;&lt;%ds&quot;</highlight><highlight class="normal"><sp/>%<sp/>(nm_len<sp/>-<sp/>1),<sp/>data[hdr_sz:hdr_sz<sp/>+<sp/>nm_len<sp/>-<sp/>1])[0].decode(</highlight><highlight class="stringliteral">&apos;ascii&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1Elf32NoteDesc_1afa7d221d6651db49f91915160ddba46f" kindref="member">desc</ref>desc<sp/>=<sp/>data[hdr_sz<sp/>+<sp/>nm_len_a:hdr_sz<sp/>+<sp/>nm_len_a<sp/>+<sp/>desc_len]</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desc_len_a<sp/>=<sp/>desc_len<sp/>+<sp/>((4<sp/>-<sp/>desc_len)<sp/>%<sp/>4)</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hdr_sz<sp/>+<sp/>nm_len_a<sp/>+<sp/>desc_len_a</highlight></codeline>
<codeline lineno="211"><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213" refid="classespcoredump_1_1XtensaPrStatus" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1XtensaPrStatus" kindref="compound">XtensaPrStatus</ref>(<ref refid="classespcoredump_1_1BinStruct" kindref="compound">BinStruct</ref>):</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Xtensa<sp/>program<sp/>status<sp/>structure&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;si_signo&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;si_code&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;si_errno&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_cursig&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_pad0&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_sigpend&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_sighold&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_pid&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_ppid&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_pgrp&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_sid&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_utime&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_stime&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_cutime&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;pr_cstime&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>format<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;3LHHLLLLLLQQQQ&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight></codeline>
<codeline lineno="231" refid="classespcoredump_1_1EspCoreDumpTaskStatus" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1EspCoreDumpTaskStatus" kindref="compound">EspCoreDumpTaskStatus</ref>(<ref refid="classespcoredump_1_1BinStruct" kindref="compound">BinStruct</ref>):</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>status<sp/>structure&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>task<sp/>status<sp/>flags<sp/>for<sp/>note</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/>TASK_STATUS_CORRECT<sp/>=<sp/>0x00</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>TASK_STATUS_TCB_CORRUPTED<sp/>=<sp/>0x01</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/>TASK_STATUS_STACK_CORRUPTED<sp/>=<sp/>0x02</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/>fields<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;task_index&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;task_flags&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;task_tcb_addr&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;task_stack_start&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;task_stack_len&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;task_name&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/>format<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;LLLLL16s&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight></codeline>
<codeline lineno="246" refid="classespcoredump_1_1ESPCoreDumpSegment" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSegment" kindref="compound">ESPCoreDumpSegment</ref>(esptool.ImageSegment):</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Wrapper<sp/>class<sp/>for<sp/>a<sp/>program<sp/>segment<sp/>in<sp/>core<sp/>ELF<sp/>file,<sp/>has<sp/>a<sp/>segment</highlight></codeline>
<codeline lineno="248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type<sp/>and<sp/>flags<sp/>as<sp/>well<sp/>as<sp/>the<sp/>common<sp/>properties<sp/>of<sp/>an<sp/>ImageSegment.</highlight></codeline>
<codeline lineno="249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>segment<sp/>flags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/>PF_X<sp/>=<sp/>0x1<sp/><sp/></highlight><highlight class="comment">#<sp/>Execute</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>PF_W<sp/>=<sp/>0x2<sp/><sp/></highlight><highlight class="comment">#<sp/>Write</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/>PF_R<sp/>=<sp/>0x4<sp/><sp/></highlight><highlight class="comment">#<sp/>Read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255" refid="classespcoredump_1_1ESPCoreDumpSegment_1af9bfc445786addfd4a6f4351fb755243" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSegment_1af9bfc445786addfd4a6f4351fb755243" kindref="member">__init__</ref>(self,<sp/>addr,<sp/>data,<sp/>type,<sp/>flags):</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>program<sp/>segment</highlight></codeline>
<codeline lineno="257"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpSegment,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1af9bfc445786addfd4a6f4351fb755243" kindref="member">__init__</ref>(addr,<sp/>data)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ab6ff8d5d50be8674c35286cf7e171df8" kindref="member">flags</ref>flags<sp/>=<sp/>flags</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ac028685dbebf68ec5fe86c0401b6945e" kindref="member">type</ref>type<sp/>=<sp/>type</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262" refid="classespcoredump_1_1ESPCoreDumpSegment_1a2168dcb72b751038c868ba8ef42e57c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a2168dcb72b751038c868ba8ef42e57c3" kindref="member">__repr__</ref>(self):</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>string<sp/>representation<sp/>of<sp/>program<sp/>segment</highlight></codeline>
<codeline lineno="264"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ac028685dbebf68ec5fe86c0401b6945e" kindref="member">type</ref>type,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a941adec7e2b0b409921e414074ecfee3" kindref="member">attr_str</ref>attr_str(),<sp/>super(ESPCoreDumpSegment,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a2168dcb72b751038c868ba8ef42e57c3" kindref="member">__repr__</ref>())</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267" refid="classespcoredump_1_1ESPCoreDumpSegment_1a941adec7e2b0b409921e414074ecfee3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a941adec7e2b0b409921e414074ecfee3" kindref="member">attr_str</ref>(self):</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>string<sp/>representation<sp/>of<sp/>program<sp/>segment<sp/>attributes</highlight></codeline>
<codeline lineno="269"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ab6ff8d5d50be8674c35286cf7e171df8" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a22792776a248bd509fc2e9f0f7f36490" kindref="member">PF_R</ref>PF_R:</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;R&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ab6ff8d5d50be8674c35286cf7e171df8" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1a40d389f282bed14e1af53cbe4c132b3f" kindref="member">PF_W</ref>PF_W:</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;W&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ab6ff8d5d50be8674c35286cf7e171df8" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSegment_1ab5ddd3b792ae0cf979e66b62b7e7debd" kindref="member">PF_X</ref>PF_X:</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>str</highlight></codeline>
<codeline lineno="284"><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286" refid="classespcoredump_1_1ESPCoreDumpSection" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSection" kindref="compound">ESPCoreDumpSection</ref>(esptool.ELFSection):</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Wrapper<sp/>class<sp/>for<sp/>a<sp/>section<sp/>in<sp/>core<sp/>ELF<sp/>file,<sp/>has<sp/>a<sp/>section</highlight></codeline>
<codeline lineno="288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flags<sp/>as<sp/>well<sp/>as<sp/>the<sp/>common<sp/>properties<sp/>of<sp/>an<sp/>esptool.ELFSection.</highlight></codeline>
<codeline lineno="289"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>section<sp/>flags</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/>SHF_WRITE<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x1</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>SHF_ALLOC<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x2</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>SHF_EXECINSTR<sp/><sp/><sp/>=<sp/>0x4</highlight></codeline>
<codeline lineno="294"><highlight class="normal"></highlight></codeline>
<codeline lineno="295" refid="classespcoredump_1_1ESPCoreDumpSection_1ad6dd052e7a4a8ea68143f56a6076daa3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSection_1ad6dd052e7a4a8ea68143f56a6076daa3" kindref="member">__init__</ref>(self,<sp/>name,<sp/>addr,<sp/>data,<sp/>flags):</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>section</highlight></codeline>
<codeline lineno="297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpSection,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpSection_1ad6dd052e7a4a8ea68143f56a6076daa3" kindref="member">__init__</ref>(name,<sp/>addr,<sp/>data)</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1aeca1d334548233435bd10453279d877f" kindref="member">flags</ref>flags<sp/>=<sp/>flags</highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight></codeline>
<codeline lineno="301" refid="classespcoredump_1_1ESPCoreDumpSection_1a25ecc2f96c2dfcfe2b562edf2ed8d33a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSection_1a25ecc2f96c2dfcfe2b562edf2ed8d33a" kindref="member">__repr__</ref>(self):</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>string<sp/>representation<sp/>of<sp/>section</highlight></codeline>
<codeline lineno="303"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(super(ESPCoreDumpSection,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpSection_1a25ecc2f96c2dfcfe2b562edf2ed8d33a" kindref="member">__repr__</ref>(),<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1a7fcee5b10d18a7052139c9e911f8feef" kindref="member">attr_str</ref>attr_str())</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306" refid="classespcoredump_1_1ESPCoreDumpSection_1a7fcee5b10d18a7052139c9e911f8feef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpSection_1a7fcee5b10d18a7052139c9e911f8feef" kindref="member">attr_str</ref>(self):</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>string<sp/>representation<sp/>of<sp/>section<sp/>attributes</highlight></codeline>
<codeline lineno="308"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;R&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1aeca1d334548233435bd10453279d877f" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1aefb44b51ba026bdb1dfcdbc2e850d98f" kindref="member">SHF_WRITE</ref>SHF_WRITE:</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;W&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1aeca1d334548233435bd10453279d877f" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1a5742511491d56ab059da11006030e1af" kindref="member">SHF_EXECINSTR</ref>SHF_EXECINSTR:</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;X&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1aeca1d334548233435bd10453279d877f" kindref="member">flags</ref>flags<sp/>&amp;<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpSection_1a00c5f4584748ec3ef551450d0ec32006" kindref="member">SHF_ALLOC</ref>SHF_ALLOC:</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>str</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325" refid="classespcoredump_1_1ESPCoreDumpElfFile" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>(esptool.ELFFile):</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Wrapper<sp/>class<sp/>for<sp/>core<sp/>dump<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="327"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>extra<sp/>regs<sp/>IDs<sp/>used<sp/>in<sp/>EXTRA_INFO<sp/>note</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EXCCAUSE_IDX<sp/><sp/><sp/><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EXCVADDR_IDX<sp/><sp/><sp/><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS2_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS3_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>3</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS4_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>4</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS5_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>5</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS6_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>6</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPS7_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>7</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC1_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>8</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC2_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>9</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC3_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>10</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC4_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>11</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC5_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>12</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC6_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>13</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/>REG_EPC7_IDX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>14</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ELF<sp/>file<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>ET_NONE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x0<sp/><sp/></highlight><highlight class="comment">#<sp/>No<sp/>file<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>ET_REL<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x1<sp/><sp/></highlight><highlight class="comment">#<sp/>Relocatable<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>ET_EXEC<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x2<sp/><sp/></highlight><highlight class="comment">#<sp/>Executable<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>ET_DYN<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x3<sp/><sp/></highlight><highlight class="comment">#<sp/>Shared<sp/>object<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/>ET_CORE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x4<sp/><sp/></highlight><highlight class="comment">#<sp/>Core<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ELF<sp/>file<sp/>version</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>EV_NONE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x0</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>EV_CURRENT<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x1</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>ELF<sp/>file<sp/>machine<sp/>type</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>EM_NONE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x0</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>EM_XTENSA<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x5E</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>section<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/>SEC_TYPE_PROGBITS<sp/><sp/><sp/>=<sp/>0x01</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/>SEC_TYPE_STRTAB<sp/><sp/><sp/><sp/><sp/>=<sp/>0x03</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>special<sp/>section<sp/>index</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/>SHN_UNDEF<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x0</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>program<sp/>segment<sp/>types</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_NULL<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x0</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_LOAD<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x1</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_DYNAMIC<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x2</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_INTERP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x3</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_NOTE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x4</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_SHLIB<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x5</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>PT_PHDR<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0x6</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370" refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeda256e3a1a9d706d71ee65f1518960e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeda256e3a1a9d706d71ee65f1518960e" kindref="member">__init__</ref>(self,<sp/>name=None):</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>core<sp/>dump<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="372"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name:</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpElfFile,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeda256e3a1a9d706d71ee65f1518960e" kindref="member">__init__</ref>(name)</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeffce9b0f10900fd014e1ef74e77d5c8" kindref="member">sections</ref>sections<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a20acb034e75e140db38f66864934ae64" kindref="member">e_type</ref>e_type<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aced184cc67bc6f6d92666d2ef12761e2" kindref="member">ET_NONE</ref>ET_NONE</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ae509b7519d3fd5edb42cc92960999bc8" kindref="member">e_machine</ref>e_machine<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a6db4b3a54348c6bc0976b86e5ed81ac6" kindref="member">EM_NONE</ref>EM_NONE</highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382" refid="classespcoredump_1_1ESPCoreDumpElfFile_1a6818d2533f2253a86b1fa28dcbbe9407" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a6818d2533f2253a86b1fa28dcbbe9407" kindref="member">_read_elf_file</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>core<sp/>dump<sp/>from<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="384"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>the<sp/>ELF<sp/>file<sp/>header</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LEN_FILE_HEADER<sp/>=<sp/>0x34</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>f.read(LEN_FILE_HEADER)</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(ident,type,machine,_version,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.entrypoint,phoff,shoff,_flags,</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ehsize,<sp/>phentsize,phnum,_shentsize,</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>shnum,shstrndx)<sp/>=<sp/>struct.unpack(</highlight><highlight class="stringliteral">&quot;&lt;16sHHLLLLLHHHHHH&quot;</highlight><highlight class="normal">,<sp/>header)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>struct.error<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>read<sp/>a<sp/>valid<sp/>ELF<sp/>header<sp/>from<sp/>%s:<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(f.name,<sp/>e))</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>bytearray([ident[0]])<sp/>!=<sp/>b</highlight><highlight class="stringliteral">&apos;\x7f&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>ident[1:4]<sp/>!=<sp/>b</highlight><highlight class="stringliteral">&apos;ELF&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;%s<sp/>has<sp/>invalid<sp/>ELF<sp/>magic<sp/>header&quot;</highlight><highlight class="normal"><sp/>%<sp/>f.name)</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>machine<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a1979fce1080d5a403b769dfa2f0d8cc3" kindref="member">EM_XTENSA</ref>EM_XTENSA:</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;%s<sp/>does<sp/>not<sp/>appear<sp/>to<sp/>be<sp/>an<sp/>Xtensa<sp/>ELF<sp/>file.<sp/>e_machine=%04x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(f.name,<sp/>machine))</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a20acb034e75e140db38f66864934ae64" kindref="member">e_type</ref>e_type<sp/>=<sp/>type</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ae509b7519d3fd5edb42cc92960999bc8" kindref="member">e_machine</ref>e_machine<sp/>=<sp/>machine</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeffce9b0f10900fd014e1ef74e77d5c8" kindref="member">sections</ref>sections<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>shnum<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a934cc2b6827923f67ac83ed08dcfc71c" kindref="member">_read_sections</ref>_read_sections(f,<sp/>shoff,<sp/>shstrndx)</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>phnum<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1abc76c91f70ba776474863b6ac8174da5" kindref="member">_read_program_segments</ref>_read_program_segments(f,<sp/>phoff,<sp/>phentsize,<sp/>phnum)</highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight></codeline>
<codeline lineno="410" refid="classespcoredump_1_1ESPCoreDumpElfFile_1a934cc2b6827923f67ac83ed08dcfc71c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a934cc2b6827923f67ac83ed08dcfc71c" kindref="member">_read_sections</ref>(self,<sp/>f,<sp/>section_header_offs,<sp/>shstrndx):</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>core<sp/>dump<sp/>sections<sp/>from<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(section_header_offs)</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>section_header<sp/>=<sp/>f.read()</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LEN_SEC_HEADER<sp/>=<sp/>0x28</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(section_header)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>section<sp/>header<sp/>found<sp/>at<sp/>offset<sp/>%04x<sp/>in<sp/>ELF<sp/>file.&quot;</highlight><highlight class="normal"><sp/>%<sp/>section_header_offs)</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(section_header)<sp/>%<sp/>LEN_SEC_HEADER<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&apos;Unexpected<sp/>ELF<sp/>section<sp/>header<sp/>length<sp/>%04x<sp/>is<sp/>not<sp/>mod-%02x&apos;</highlight><highlight class="normal"><sp/>%<sp/>(len(section_header),LEN_SEC_HEADER))</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>walk<sp/>through<sp/>the<sp/>section<sp/>header<sp/>and<sp/>extract<sp/>all<sp/>sections</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>section_header_offsets<sp/>=<sp/>range(0,<sp/>len(section_header),<sp/>LEN_SEC_HEADER)</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">read_section_header(offs):</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name_offs,sec_type,flags,lma,sec_offs,size<sp/>=<sp/>struct.unpack_from(</highlight><highlight class="stringliteral">&quot;&lt;LLLLLL&quot;</highlight><highlight class="normal">,<sp/>section_header[offs:])</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(name_offs,<sp/>sec_type,<sp/>flags,<sp/>lma,<sp/>size,<sp/>sec_offs)</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_sections<sp/>=<sp/>[read_section_header(offs)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>offs<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>section_header_offsets]</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prog_sections<sp/>=<sp/>[s<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>all_sections<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>s[1]<sp/>==<sp/>esptool.ELFFile.SEC_TYPE_PROGBITS]</highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>search<sp/>for<sp/>the<sp/>string<sp/>table<sp/>section</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>shstrndx<sp/>*<sp/>LEN_SEC_HEADER<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>section_header_offsets:</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;ELF<sp/>file<sp/>has<sp/>no<sp/>STRTAB<sp/>section<sp/>at<sp/>shstrndx<sp/>%d&quot;</highlight><highlight class="normal"><sp/>%<sp/>shstrndx)</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_,sec_type,_,_,sec_size,sec_offs<sp/>=<sp/>read_section_header(shstrndx<sp/>*<sp/>LEN_SEC_HEADER)</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sec_type<sp/>!=<sp/>esptool.ELFFile.SEC_TYPE_STRTAB:</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&apos;ELF<sp/>file<sp/>has<sp/>incorrect<sp/>STRTAB<sp/>section<sp/>type<sp/>0x%02x&apos;</highlight><highlight class="normal"><sp/>%<sp/>sec_type)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(sec_offs)</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string_table<sp/>=<sp/>f.read(sec_size)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>build<sp/>the<sp/>real<sp/>list<sp/>of<sp/>ELFSections<sp/>by<sp/>reading<sp/>the<sp/>actual<sp/>section<sp/>names<sp/>from<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>string<sp/>table<sp/>section,<sp/>and<sp/>actual<sp/>data<sp/>for<sp/>each<sp/>section<sp/>from<sp/>the<sp/>ELF<sp/>file<sp/>itself</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">lookup_string(offs):</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>raw<sp/>=<sp/>string_table[offs:]</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>raw[:raw.index(b</highlight><highlight class="stringliteral">&apos;\x00&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="444"><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">read_data(offs,size):</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(offs)</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.read(size)</highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prog_sections<sp/>=<sp/>[<ref refid="classespcoredump_1_1ESPCoreDumpSection" kindref="compound">ESPCoreDumpSection</ref>(lookup_string(n_offs),<sp/>lma,<sp/>read_data(offs,<sp/>size),<sp/>flags)</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(n_offs,<sp/>_type,<sp/>flags,<sp/>lma,<sp/>size,<sp/>offs)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>prog_sections<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>lma<sp/>!=<sp/>0]</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1aeffce9b0f10900fd014e1ef74e77d5c8" kindref="member">sections</ref>sections<sp/>=<sp/>prog_sections</highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight></codeline>
<codeline lineno="453" refid="classespcoredump_1_1ESPCoreDumpElfFile_1abc76c91f70ba776474863b6ac8174da5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1abc76c91f70ba776474863b6ac8174da5" kindref="member">_read_program_segments</ref>(self,<sp/>f,<sp/>seg_table_offs,<sp/>entsz,<sp/>num):</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>core<sp/>dump<sp/>program<sp/>segments<sp/>from<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="455"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(seg_table_offs)</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_table<sp/>=<sp/>f.read(entsz<sp/>*<sp/>num)</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>LEN_SEG_HEADER<sp/>=<sp/>0x20</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(seg_table)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;No<sp/>program<sp/>header<sp/>table<sp/>found<sp/>at<sp/>offset<sp/>%04x<sp/>in<sp/>ELF<sp/>file.&quot;</highlight><highlight class="normal"><sp/>%<sp/>seg_table_offs)</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(seg_table)<sp/>%<sp/>LEN_SEG_HEADER<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&apos;Unexpected<sp/>ELF<sp/>program<sp/>header<sp/>table<sp/>length<sp/>%04x<sp/>is<sp/>not<sp/>mod-%02x&apos;</highlight><highlight class="normal"><sp/>%<sp/>(len(seg_table),LEN_SEG_HEADER))</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>walk<sp/>through<sp/>the<sp/>program<sp/>segment<sp/>table<sp/>and<sp/>extract<sp/>all<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_table_offs<sp/>=<sp/>range(0,<sp/>len(seg_table),<sp/>LEN_SEG_HEADER)</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">read_program_header(offs):</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type,offset,vaddr,_paddr,filesz,_memsz,flags,_align<sp/>=<sp/>struct.unpack_from(</highlight><highlight class="stringliteral">&quot;&lt;LLLLLLLL&quot;</highlight><highlight class="normal">,<sp/>seg_table[offs:])</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(type,offset,vaddr,filesz,flags)</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prog_segments<sp/>=<sp/>[read_program_header(offs)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>offs<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>seg_table_offs]</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>build<sp/>the<sp/>real<sp/>list<sp/>of<sp/>ImageSegment<sp/>by<sp/>reading<sp/>actual<sp/>data<sp/>for<sp/>each<sp/>segment<sp/>from<sp/>the<sp/>ELF<sp/>file<sp/>itself</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">read_data(offs,size):</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(offs)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f.read(size)</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>loadable<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments<sp/>=<sp/>[<ref refid="classespcoredump_1_1ESPCoreDumpSegment" kindref="compound">ESPCoreDumpSegment</ref>(vaddr,<sp/>read_data(offset,<sp/>filesz),<sp/>type,<sp/>flags)</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(type,<sp/>offset,<sp/>vaddr,<sp/>filesz,flags)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>prog_segments<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>vaddr<sp/>!=<sp/>0]</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments<sp/>=<sp/>[<ref refid="classespcoredump_1_1ESPCoreDumpSegment" kindref="compound">ESPCoreDumpSegment</ref>(vaddr,<sp/>read_data(offset,<sp/>filesz),<sp/>type,<sp/>flags)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(type,<sp/>offset,<sp/>vaddr,<sp/>filesz,<sp/>flags)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>prog_segments<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type<sp/>==<sp/>ESPCoreDumpElfFile.PT_NOTE<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>vaddr<sp/>==<sp/>0]</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482" refid="classespcoredump_1_1ESPCoreDumpElfFile_1a8a855af40d0ed039fd0fa3e4c92c0605" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a8a855af40d0ed039fd0fa3e4c92c0605" kindref="member">add_program_segment</ref>(self,<sp/>addr,<sp/>data,<sp/>type,<sp/>flags):</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Adds<sp/>new<sp/>program<sp/>segment</highlight></codeline>
<codeline lineno="484"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>currently<sp/>merging<sp/>with<sp/>existing<sp/>segments<sp/>is<sp/>not<sp/>supported</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_sz<sp/>=<sp/>len(data)</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>check<sp/>for<sp/>overlapping<sp/>and<sp/>merge<sp/>if<sp/>needed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>addr<sp/>!=<sp/>0<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>data_sz<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ps<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments:</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_len<sp/>=<sp/>len(ps.data)</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>addr<sp/>&gt;=<sp/>ps.addr<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>addr<sp/>&lt;<sp/>(ps.addr<sp/>+<sp/>seg_len):</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;Can<sp/>not<sp/>add<sp/>overlapping<sp/>region<sp/>[%x..%x]<sp/>to<sp/>ELF<sp/>file.<sp/>Conflict<sp/>with<sp/>existing<sp/>[%x..%x].&quot;</highlight><highlight class="normal"><sp/>%</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(addr,<sp/>addr<sp/>+<sp/>data_sz<sp/>-<sp/>1,<sp/>ps.addr,<sp/>ps.addr<sp/>+<sp/>seg_len<sp/>-<sp/>1))</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(addr<sp/>+<sp/>data_sz)<sp/>&gt;<sp/>ps.addr<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>(addr<sp/>+<sp/>data_sz)<sp/>&lt;=<sp/>(ps.addr<sp/>+<sp/>seg_len):</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;Can<sp/>not<sp/>add<sp/>overlapping<sp/>region<sp/>[%x..%x]<sp/>to<sp/>ELF<sp/>file.<sp/>Conflict<sp/>with<sp/>existing<sp/>[%x..%x].&quot;</highlight><highlight class="normal"><sp/>%</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(addr,<sp/>addr<sp/>+<sp/>data_sz<sp/>-<sp/>1,<sp/>ps.addr,<sp/>ps.addr<sp/>+<sp/>seg_len<sp/>-<sp/>1))</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>append</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments.append(<ref refid="classespcoredump_1_1ESPCoreDumpSegment" kindref="compound">ESPCoreDumpSegment</ref>(addr,<sp/>data,<sp/>type,<sp/>flags))</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500" refid="classespcoredump_1_1ESPCoreDumpElfFile_1a33f00974faa775490cc44529f3856283" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a33f00974faa775490cc44529f3856283" kindref="member">add_aux_segment</ref>(self,<sp/>data,<sp/>type,<sp/>flags):</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Adds<sp/>new<sp/>note<sp/>segment</highlight></codeline>
<codeline lineno="502"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments.append(<ref refid="classespcoredump_1_1ESPCoreDumpSegment" kindref="compound">ESPCoreDumpSegment</ref>(0,<sp/>data,<sp/>type,<sp/>flags))</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">write_program_headers(self,<sp/>f,<sp/>off,<sp/>segs):</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>seg<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>segs:</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32ProgramHeader" kindref="compound">Elf32ProgramHeader</ref>()</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_type<sp/>=<sp/>seg.type</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_offset<sp/>=<sp/>off</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_vaddr<sp/>=<sp/>seg.addr</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_paddr<sp/>=<sp/>phdr.p_vaddr<sp/><sp/></highlight><highlight class="comment">#<sp/>TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_filesz<sp/>=<sp/>len(seg.data)</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_memsz<sp/>=<sp/>phdr.p_filesz<sp/><sp/></highlight><highlight class="comment">#<sp/>TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_flags<sp/>=<sp/>seg.flags</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>phdr.p_align<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>TODO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.write(phdr.dump())</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>off<sp/>+=<sp/>phdr.p_filesz</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>off</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520" refid="classespcoredump_1_1ESPCoreDumpElfFile_1abb77b6d529bd43348b0dd946fdf78d4d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1abb77b6d529bd43348b0dd946fdf78d4d" kindref="member">dump</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Write<sp/>core<sp/>dump<sp/>contents<sp/>to<sp/>file</highlight></codeline>
<codeline lineno="522"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>currently<sp/>dumps<sp/>only<sp/>program<sp/>segments.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>dumping<sp/>sections<sp/>is<sp/>not<sp/>supported<sp/>yet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>write<sp/>ELF<sp/>header</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32FileHeader" kindref="compound">Elf32FileHeader</ref>()</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_type<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a20acb034e75e140db38f66864934ae64" kindref="member">e_type</ref>e_type</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_machine<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ae509b7519d3fd5edb42cc92960999bc8" kindref="member">e_machine</ref>e_machine</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_entry<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_phoff<sp/>=<sp/>ehdr.sizeof()</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_shoff<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_flags<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_phentsize<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32ProgramHeader" kindref="compound">Elf32ProgramHeader</ref>().sizeof()</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_phnum<sp/>=<sp/>len(self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments)<sp/>+<sp/>len(self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments)</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_shentsize<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_shnum<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ehdr.e_shstrndx<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a22bfefe321b8a50cfe09df65eb9d245b" kindref="member">SHN_UNDEF</ref>SHN_UNDEF</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.write(ehdr.dump())</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>write<sp/>program<sp/>header<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cur_off<sp/>=<sp/>ehdr.e_ehsize<sp/>+<sp/>ehdr.e_phnum<sp/>*<sp/>ehdr.e_phentsize</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cur_off<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a141dc9f9f37f7a30996a3242d9995b34" kindref="member">write_program_headers</ref>write_program_headers(f,<sp/>cur_off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments)</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cur_off<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a141dc9f9f37f7a30996a3242d9995b34" kindref="member">write_program_headers</ref>write_program_headers(f,<sp/>cur_off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments)</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>write<sp/>program<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>segment<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1a49cbb513665162f3efb5976304f30e28" kindref="member">program_segments</ref>program_segments:</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.write(segment.data)</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>write<sp/>aux<sp/>program<sp/>segments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>segment<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpElfFile_1ad3554bf2ffa3edec53437c47788a4214" kindref="member">aux_segments</ref>aux_segments:</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.write(segment.data)</highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551" refid="classespcoredump_1_1ESPCoreDumpLoaderError" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(<ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>):</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>loader<sp/>error<sp/>class</highlight></codeline>
<codeline lineno="553"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554" refid="classespcoredump_1_1ESPCoreDumpLoaderError_1a53c6232ce8058801913e843cc44a1fa5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError_1a53c6232ce8058801913e843cc44a1fa5" kindref="member">__init__</ref>(self,<sp/>message):</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>core<sp/>dump<sp/>loader<sp/>error</highlight></codeline>
<codeline lineno="556"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpLoaderError,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpLoaderError_1a53c6232ce8058801913e843cc44a1fa5" kindref="member">__init__</ref>(message)</highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">esp_core_dump_ver(chip,<sp/>maj,<sp/>min):</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(((chip<sp/>&amp;<sp/>0xFFFF)<sp/>&lt;&lt;<sp/>16)<sp/>|<sp/>((maj<sp/>&amp;<sp/>0xFF)<sp/>&lt;&lt;<sp/>8)<sp/>|<sp/>((min<sp/>&amp;<sp/>0xFF)<sp/>&lt;&lt;<sp/>0))</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564" refid="classespcoredump_1_1ESPCoreDumpLoader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader" kindref="compound">ESPCoreDumpLoader</ref>(object):</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>loader<sp/>base<sp/>class</highlight></codeline>
<codeline lineno="566"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>add<sp/>class<sp/>for<sp/>core<sp/>dump<sp/>version<sp/>and<sp/>move<sp/>all<sp/>version-dependent<sp/>params<sp/>to<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_CORE_DUMP_CHIP_ESP32<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&quot;legacy&quot;<sp/>stands<sp/>for<sp/>core<sp/>dumps<sp/>v0.1<sp/>(before<sp/>IDF<sp/>v4.1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_VERSION_BIN_V1<sp/>=<sp/>esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32,<sp/>0,<sp/>1)</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_VERSION_BIN_V2<sp/>=<sp/>esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32,<sp/>0,<sp/>2)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_VERSION_ELF_CRC32<sp/>=<sp/>esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32,<sp/>1,<sp/>0)</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_VERSION_ELF_SHA256<sp/>=<sp/>esp_core_dump_ver(ESP_CORE_DUMP_CHIP_ESP32,<sp/>1,<sp/>1)</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_CORE_DUMP_INFO_TYPE<sp/>=<sp/>8266</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_CORE_DUMP_TASK_INFO_TYPE<sp/>=<sp/>678</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_CORE_DUMP_EXTRA_INFO_TYPE<sp/>=<sp/>677</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_COREDUMP_CURR_TASK_MARKER<sp/>=<sp/>0xdeadbeef</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_BIN_V1_HDR_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;4L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_BIN_V1_HDR_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_BIN_V1_HDR_FMT)</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_HDR_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;5L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_HDR_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_HDR_FMT)</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_TSK_HDR_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;3L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_TSK_HDR_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_TSK_HDR_FMT)</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_MEM_SEG_HDR_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;2L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_MEM_SEG_HDR_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_MEM_SEG_HDR_FMT)</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_NOTE_HDR_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;3L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_NOTE_HDR_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_NOTE_HDR_FMT)</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_CRC_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_CRC_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_CRC_FMT)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_SHA256_FMT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;32c&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_SHA256_SZ<sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_SHA256_FMT)</highlight></codeline>
<codeline lineno="592"><highlight class="normal"></highlight></codeline>
<codeline lineno="593" refid="classespcoredump_1_1ESPCoreDumpLoader_1a0bc5bd2a670eaebd0e1e48387d672fa9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0bc5bd2a670eaebd0e1e48387d672fa9" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Base<sp/>constructor<sp/>for<sp/>core<sp/>dump<sp/>loader</highlight></codeline>
<codeline lineno="595"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref>fcore<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599" refid="classespcoredump_1_1ESPCoreDumpLoader_1a65bbc5b449ecd26a55c854df72e36186" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a65bbc5b449ecd26a55c854df72e36186" kindref="member">_get_registers_from_stack</ref>(self,<sp/>data,<sp/>grows_down):</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Returns<sp/>list<sp/>of<sp/>registers<sp/>(in<sp/>GDB<sp/>format)<sp/>from<sp/>xtensa<sp/>stack<sp/>frame</highlight></codeline>
<codeline lineno="601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>from<sp/>&quot;gdb/xtensa-tdep.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>typedef<sp/>struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>0<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>pc;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>1<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>ps;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>2<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>lbeg;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>3<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>lend;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>4<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>lcount;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>5<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>sar;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>6<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>windowstart;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>7<sp/><sp/><sp/><sp/>xtensa_elf_greg_t<sp/>windowbase;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>8..63<sp/>xtensa_elf_greg_t<sp/>reserved[8+48];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>64<sp/><sp/><sp/>xtensa_elf_greg_t<sp/>ar[64];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>}<sp/>xtensa_elf_gregset_t;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_PC_IDX<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_PS_IDX<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_LB_IDX<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_LE_IDX<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_LC_IDX<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_SAR_IDX<sp/>=<sp/>5</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>REG_WS_IDX<sp/>=<sp/>6</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>REG_WB_IDX<sp/>=<sp/>7</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_AR_START_IDX<sp/>=<sp/>64</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>REG_AR_NUM<sp/>=<sp/>64</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>FIXME:<sp/>acc<sp/>to<sp/>xtensa_elf_gregset_t<sp/>number<sp/>of<sp/>regs<sp/>must<sp/>be<sp/>128,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>but<sp/>gdb<sp/>complanis<sp/>when<sp/>it<sp/>less<sp/>then<sp/>129</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>REG_NUM<sp/>=<sp/>129</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>XT_SOL_EXIT<sp/>=<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_SOL_PC<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_SOL_PS<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>XT_SOL_NEXT<sp/>=<sp/>3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_SOL_AR_START<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_SOL_AR_NUM<sp/>=<sp/>4</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>XT_SOL_FRMSZ<sp/>=<sp/>8</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_EXIT<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_PC<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_PS<sp/>=<sp/>2</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_AR_START<sp/>=<sp/>3</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_AR_NUM<sp/>=<sp/>16</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_SAR<sp/>=<sp/>19</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_EXCCAUSE<sp/>=<sp/>20</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_EXCVADDR<sp/>=<sp/>21</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_LBEG<sp/>=<sp/>22</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_LEND<sp/>=<sp/>23</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_LCOUNT<sp/>=<sp/>24</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>XT_STK_FRMSZ<sp/>=<sp/>25</highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_regs<sp/>=<sp/>{ESPCoreDumpElfFile.REG_EPS2_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPS3_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPS4_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPS5_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPS6_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPS7_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPC1_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPC2_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPC3_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPC4_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPC5_IDX:<sp/>0,<sp/>ESPCoreDumpElfFile.REG_EPC6_IDX:<sp/>0,</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.REG_EPC7_IDX:<sp/>0}</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs<sp/>=<sp/>[0]<sp/>*<sp/>REG_NUM</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>support<sp/>for<sp/>growing<sp/>up<sp/>stacks</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>grows_down:</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Growing<sp/>up<sp/>stacks<sp/>are<sp/>not<sp/>supported<sp/>for<sp/>now!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ex_struct<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;%dL&quot;</highlight><highlight class="normal"><sp/>%<sp/>XT_STK_FRMSZ</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(data)<sp/>&lt;<sp/>struct.calcsize(ex_struct):</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Too<sp/>small<sp/>stack<sp/>to<sp/>keep<sp/>frame:<sp/>%d<sp/>bytes!&quot;</highlight><highlight class="normal"><sp/>%<sp/>len(data))</highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack<sp/>=<sp/>struct.unpack(ex_struct,<sp/>data[:struct.calcsize(ex_struct)])</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Stack<sp/>frame<sp/>type<sp/>indicator<sp/>is<sp/>always<sp/>the<sp/>first<sp/>item</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc<sp/>=<sp/>stack[XT_STK_EXIT]</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rc<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_PC_IDX]<sp/>=<sp/>stack[XT_STK_PC]</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_PS_IDX]<sp/>=<sp/>stack[XT_STK_PS]</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(XT_STK_AR_NUM):</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_AR_START_IDX<sp/>+<sp/>i]<sp/>=<sp/>stack[XT_STK_AR_START<sp/>+<sp/>i]</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_SAR_IDX]<sp/>=<sp/>stack[XT_STK_SAR]</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_LB_IDX]<sp/>=<sp/>stack[XT_STK_LBEG]</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_LE_IDX]<sp/>=<sp/>stack[XT_STK_LEND]</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_LC_IDX]<sp/>=<sp/>stack[XT_STK_LCOUNT]</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>FIXME:<sp/>crashed<sp/>and<sp/>some<sp/>running<sp/>tasks<sp/>(e.g.<sp/>prvIdleTask)<sp/>have<sp/>EXCM<sp/>bit<sp/>set</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>and<sp/>GDB<sp/>can<sp/>not<sp/>unwind<sp/>callstack<sp/>properly<sp/>(it<sp/>implies<sp/>not<sp/>windowed<sp/>call0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>regs[REG_PS_IDX]<sp/>&amp;<sp/>(1<sp/>&lt;&lt;<sp/>5):</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_PS_IDX]<sp/>&amp;=<sp/>~(1<sp/>&lt;&lt;<sp/>4)</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>stack[XT_STK_EXCCAUSE]<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>xtensa_exception_cause_dict:</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_regs[ESPCoreDumpElfFile.REG_EXCCAUSE_IDX]<sp/>=<sp/>stack[XT_STK_EXCCAUSE]</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_regs[ESPCoreDumpElfFile.REG_EXCCAUSE_IDX]<sp/>=<sp/>INVALID_CAUSE_VALUE</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_regs[ESPCoreDumpElfFile.REG_EXCVADDR_IDX]<sp/>=<sp/>stack[XT_STK_EXCVADDR]</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_PC_IDX]<sp/>=<sp/>stack[XT_SOL_PC]</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_PS_IDX]<sp/>=<sp/>stack[XT_SOL_PS]</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(XT_SOL_AR_NUM):</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>regs[REG_AR_START_IDX<sp/>+<sp/>i]<sp/>=<sp/>stack[XT_SOL_AR_START<sp/>+<sp/>i]</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>nxt<sp/>=<sp/>stack[XT_SOL_NEXT]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>regs,extra_regs</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695" refid="classespcoredump_1_1ESPCoreDumpLoader_1a9eb99313732885107fa9ca12bbae172a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9eb99313732885107fa9ca12bbae172a" kindref="member">tcb_is_sane</ref>(self,<sp/>tcb_addr,<sp/>tcb_size):</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Check<sp/>tcb<sp/>address<sp/>if<sp/>it<sp/>is<sp/>correct</highlight></codeline>
<codeline lineno="697"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>(tcb_addr<sp/>&lt;<sp/>0x3ffae000<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>(tcb_addr<sp/>+<sp/>tcb_size)<sp/>&gt;<sp/>0x40000000)</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700" refid="classespcoredump_1_1ESPCoreDumpLoader_1a4fba2fe6ef576478482de8d1fff74978" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a4fba2fe6ef576478482de8d1fff74978" kindref="member">stack_is_sane</ref>(self,<sp/>sp):</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Check<sp/>stack<sp/>address<sp/>if<sp/>it<sp/>is<sp/>correct</highlight></codeline>
<codeline lineno="702"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>not(sp<sp/>&lt;<sp/>0x3ffae010<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>sp<sp/>&gt;<sp/>0x3fffffff)</highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight></codeline>
<codeline lineno="705" refid="classespcoredump_1_1ESPCoreDumpLoader_1a2178c23df91d8eb2d469af9cd583644e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a2178c23df91d8eb2d469af9cd583644e" kindref="member">addr_is_fake</ref>(self,<sp/>addr):</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Check<sp/>if<sp/>address<sp/>is<sp/>in<sp/>fake<sp/>area</highlight></codeline>
<codeline lineno="707"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((addr<sp/>&lt;<sp/>0x3f3fffff<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>addr<sp/>&gt;=<sp/>0x20000000)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>addr<sp/>&gt;=<sp/>0x80000000)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight></codeline>
<codeline lineno="710" refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" kindref="member">remove_tmp_file</ref>(self,<sp/>fname):</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Silently<sp/>removes<sp/>temporary<sp/>file</highlight></codeline>
<codeline lineno="712"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.remove(fname)</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>OSError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>e.errno<sp/>!=<sp/>errno.ENOENT:</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>remove<sp/>temp<sp/>file<sp/>&apos;%s&apos;<sp/>(%d)!&quot;</highlight><highlight class="normal"><sp/>%<sp/>(fname,<sp/>e.errno))</highlight></codeline>
<codeline lineno="718"><highlight class="normal"></highlight></codeline>
<codeline lineno="719" refid="classespcoredump_1_1ESPCoreDumpLoader_1a7e2fc97010dcceb5bf20e462c2c2174f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a7e2fc97010dcceb5bf20e462c2c2174f" kindref="member">cleanup</ref>(self):</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Cleans<sp/>up<sp/>loader<sp/>resources</highlight></codeline>
<codeline lineno="721"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref>fcore:</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref>fcore.close()</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.fcore_name:</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" kindref="member">remove_tmp_file</ref>remove_tmp_file(self.fcore_name)</highlight></codeline>
<codeline lineno="726"><highlight class="normal"></highlight></codeline>
<codeline lineno="727" refid="classespcoredump_1_1ESPCoreDumpLoader_1a536e5e7ca863d8dbc6a7a4a465064ac3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a536e5e7ca863d8dbc6a7a4a465064ac3" kindref="member">_extract_elf_corefile</ref>(self,<sp/>core_fname=None,<sp/>off=0,<sp/>exe_name=None):</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Reads<sp/>the<sp/>ELF<sp/>formatted<sp/>core<sp/>dump<sp/>image<sp/>and<sp/>parse<sp/>it</highlight></codeline>
<codeline lineno="729"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>=<sp/>off</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ae16fc3f143565d47ab88c16c847b0927" kindref="member">ESP32_COREDUMP_VERSION_ELF_CRC32</ref>ESP32_COREDUMP_VERSION_ELF_CRC32:</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum_len<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1aa51808a5f0809bac4da3144f53426269" kindref="member">ESP32_COREDUMP_CRC_SZ</ref>ESP32_COREDUMP_CRC_SZ</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a5111917e2e17fbd5a710cc81b98f3ce8" kindref="member">ESP32_COREDUMP_VERSION_ELF_SHA256</ref>ESP32_COREDUMP_VERSION_ELF_SHA256:</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>checksum_len<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0e45d82c0f357bfc5d497d3b86629abd" kindref="member">ESP32_COREDUMP_SHA256_SZ</ref>ESP32_COREDUMP_SHA256_SZ</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Core<sp/>dump<sp/>version<sp/>&apos;%d&apos;<sp/>is<sp/>not<sp/>supported!&quot;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>()</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;tot_len&apos;</highlight><highlight class="normal">]<sp/>-<sp/>checksum_len<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9e31b52b940437262bf2aed5c6ff0f31" kindref="member">ESP32_COREDUMP_HDR_SZ</ref>ESP32_COREDUMP_HDR_SZ)</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(core_fname,<sp/></highlight><highlight class="stringliteral">&apos;w+b&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>fce:</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fce.write(data)</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fce.flush()</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fce.seek(0)</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf._read_elf_file(fce)</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>exe_name:</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exe_elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>(exe_name)</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Read<sp/>note<sp/>segments<sp/>from<sp/>core<sp/>file<sp/>which<sp/>are<sp/>belong<sp/>to<sp/>tasks<sp/>(TCB<sp/>or<sp/>stack)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ns<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>core_elf.aux_segments:</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ns.type<sp/>!=<sp/>ESPCoreDumpElfFile.PT_NOTE:</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_read<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>note_read<sp/>&lt;<sp/>len(ns.data):</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>0,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_read<sp/>+=<sp/>note.read(ns.data[note_read:])</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Check<sp/>for<sp/>version<sp/>info<sp/>note</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;ESP_CORE_DUMP_INFO&apos;</highlight><highlight class="normal"><sp/>==<sp/>note.name<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>note.type<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a4ebad28ebde9a848c52235e001796220" kindref="member">ESP_CORE_DUMP_INFO_TYPE</ref>ESP_CORE_DUMP_INFO_TYPE<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>exe_name:</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>app_sha256<sp/>=<sp/>binascii.hexlify(exe_elf.sha256())</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_ver_len<sp/>=<sp/>struct.calcsize(</highlight><highlight class="stringliteral">&quot;&lt;L&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_sha256_len<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0e45d82c0f357bfc5d497d3b86629abd" kindref="member">ESP32_COREDUMP_SHA256_SZ</ref>ESP32_COREDUMP_SHA256_SZ<sp/>*<sp/>2<sp/><sp/></highlight><highlight class="comment">#<sp/>SHA256<sp/>as<sp/>hex<sp/>string</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n_ver,coredump_sha256<sp/>=<sp/>struct.unpack(</highlight><highlight class="stringliteral">&quot;&lt;L%ds&quot;</highlight><highlight class="normal"><sp/>%<sp/>(n_sha256_len),<sp/>note.desc[:n_ver_len<sp/>+<sp/>n_sha256_len])</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>coredump_sha256<sp/>!=<sp/>app_sha256<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>n_ver<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpError" kindref="compound">ESPCoreDumpError</ref>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>application<sp/>image<sp/>for<sp/>coredump:<sp/>app_SHA256(%s)<sp/>!=<sp/>coredump_SHA256(%s).&quot;</highlight><highlight class="normal"><sp/>%</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(app_sha256,<sp/>coredump_sha256))</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>extract<sp/>ELF<sp/>core<sp/>dump<sp/>image<sp/>into<sp/>file<sp/>%s.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(core_fname,<sp/>e))</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>core_fname</highlight></codeline>
<codeline lineno="767"><highlight class="normal"></highlight></codeline>
<codeline lineno="768" refid="classespcoredump_1_1ESPCoreDumpLoader_1a08c4d26f0680f051fa4c9e9b41423191" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a08c4d26f0680f051fa4c9e9b41423191" kindref="member">_extract_bin_corefile</ref>(self,<sp/>core_fname=None,<sp/>rom_elf=None,<sp/>off=0):</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Creates<sp/>core<sp/>dump<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="770"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>=<sp/>off</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(core_fname,<sp/></highlight><highlight class="stringliteral">&apos;w+b&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>fce:</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcbsz_aligned<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;tcbsz&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>tcbsz_aligned<sp/>%<sp/>4:</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcbsz_aligned<sp/>=<sp/>4<sp/>*<sp/>(old_div(tcbsz_aligned,4)<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>()</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>notes<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_dump_info_notes<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info_notes<sp/>=<sp/>b</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status<sp/>=<sp/><ref refid="classespcoredump_1_1EspCoreDumpTaskStatus" kindref="compound">EspCoreDumpTaskStatus</ref>()</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;task_num&apos;</highlight><highlight class="normal">]):</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_index<sp/>=<sp/>i</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_flags<sp/>=<sp/>EspCoreDumpTaskStatus.TASK_STATUS_CORRECT</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a714e385c76b1c30c452167d352c1938d" kindref="member">ESP32_COREDUMP_TSK_HDR_SZ</ref>ESP32_COREDUMP_TSK_HDR_SZ)</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcb_addr,stack_top,stack_end<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a973f347dc9f8f9568f4080689aecfd52" kindref="member">ESP32_COREDUMP_TSK_HDR_FMT</ref>ESP32_COREDUMP_TSK_HDR_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>stack_end<sp/>&gt;<sp/>stack_top:</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_len<sp/>=<sp/>stack_end<sp/>-<sp/>stack_top</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_base<sp/>=<sp/>stack_top</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_len<sp/>=<sp/>stack_top<sp/>-<sp/>stack_end</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_base<sp/>=<sp/>stack_end</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_len_aligned<sp/>=<sp/>stack_len</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>stack_len_aligned<sp/>%<sp/>4:</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stack_len_aligned<sp/>=<sp/>4<sp/>*<sp/>(old_div(stack_len_aligned,4)<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>+=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a714e385c76b1c30c452167d352c1938d" kindref="member">ESP32_COREDUMP_TSK_HDR_SZ</ref>ESP32_COREDUMP_TSK_HDR_SZ</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Read<sp/>TCB<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tcbsz_aligned,<sp/>tcb_addr))</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>tcbsz_aligned)</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_tcb_addr<sp/>=<sp/>tcb_addr</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9eb99313732885107fa9ca12bbae172a" kindref="member">tcb_is_sane</ref>tcb_is_sane(tcb_addr,<sp/>tcbsz_aligned):</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;tcbsz&apos;</highlight><highlight class="normal">]<sp/>!=<sp/>tcbsz_aligned:</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(tcb_addr,<sp/>data[:self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;tcbsz&apos;</highlight><highlight class="normal">]<sp/>-<sp/>tcbsz_aligned],</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ESPCoreDumpSegment.PF_R<sp/>|<sp/>ESPCoreDumpSegment.PF_W)</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(tcb_addr,<sp/>data,<sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ESPCoreDumpSegment.PF_R<sp/>|<sp/>ESPCoreDumpSegment.PF_W)</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>task_status.task_name<sp/>=<sp/>bytearray(&quot;%s\0&quot;<sp/>%<sp/>task_name_str,<sp/>encoding=&apos;ascii&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>tcb_addr<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a2178c23df91d8eb2d469af9cd583644e" kindref="member">addr_is_fake</ref>addr_is_fake(tcb_addr):</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_flags<sp/>|=<sp/>EspCoreDumpTaskStatus.TASK_STATUS_TCB_CORRUPTED</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>TCB<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tcbsz_aligned,<sp/>tcb_addr,<sp/>e))</highlight></codeline>
<codeline lineno="812"><highlight class="normal"></highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>+=<sp/>tcbsz_aligned</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Read<sp/>stack<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(stack_len_aligned,<sp/>stack_base))</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>stack_len_aligned)</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>stack_len<sp/>!=<sp/>stack_len_aligned:</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>data[:stack_len<sp/>-<sp/>stack_len_aligned]</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_stack_start<sp/>=<sp/>stack_base</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_stack_len<sp/>=<sp/>stack_len_aligned</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a4fba2fe6ef576478482de8d1fff74978" kindref="member">stack_is_sane</ref>stack_is_sane(stack_base):</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(stack_base,<sp/>data,<sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ESPCoreDumpSegment.PF_R<sp/>|<sp/>ESPCoreDumpSegment.PF_W)</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>stack_base<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a2178c23df91d8eb2d469af9cd583644e" kindref="member">addr_is_fake</ref>addr_is_fake(stack_base):</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_status.task_flags<sp/>|=<sp/>EspCoreDumpTaskStatus.TASK_STATUS_STACK_CORRUPTED</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(stack_base,<sp/>data,<sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ESPCoreDumpSegment.PF_R<sp/>|<sp/>ESPCoreDumpSegment.PF_W)</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>task&apos;s<sp/>(%x)<sp/>stack<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(tcb_addr,<sp/>stack_len_aligned,<sp/>stack_base,<sp/>e))</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>+=<sp/>stack_len_aligned</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Stack<sp/>start_end:<sp/>0x%x<sp/>@<sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(stack_top,<sp/>stack_end))</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_regs,extra_regs<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a65bbc5b449ecd26a55c854df72e36186" kindref="member">_get_registers_from_stack</ref>_get_registers_from_stack(data,<sp/>stack_end<sp/>&gt;<sp/>stack_top)</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(e)</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info_notes<sp/>+=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;TASK_INFO&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1adad49d65e756130cf401dbf341fa6bb8" kindref="member">ESP_CORE_DUMP_TASK_INFO_TYPE</ref>ESP_CORE_DUMP_TASK_INFO_TYPE,<sp/>task_status.dump()).dump()</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prstatus<sp/>=<sp/><ref refid="classespcoredump_1_1XtensaPrStatus" kindref="compound">XtensaPrStatus</ref>()</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prstatus.pr_cursig<sp/>=<sp/>0<sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>set<sp/>sig<sp/>only<sp/>for<sp/>current/failed<sp/>task</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prstatus.pr_pid<sp/>=<sp/>tcb_addr</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;CORE&quot;</highlight><highlight class="normal">,<sp/>1,<sp/>prstatus.dump()<sp/>+<sp/>struct.pack(</highlight><highlight class="stringliteral">&quot;&lt;%dL&quot;</highlight><highlight class="normal"><sp/>%<sp/>len(task_regs),<sp/>*task_regs)).dump()</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>notes<sp/>+=<sp/>note</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ESPCoreDumpElfFile.REG_EXCCAUSE_IDX<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>extra_regs<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>len(core_dump_info_notes)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>actually<sp/>there<sp/>will<sp/>be<sp/>only<sp/>one<sp/>such<sp/>note<sp/>-<sp/>for<sp/>crashed<sp/>task</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_dump_info_notes<sp/>+=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;ESP_CORE_DUMP_INFO&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a4ebad28ebde9a848c52235e001796220" kindref="member">ESP_CORE_DUMP_INFO_TYPE</ref>ESP_CORE_DUMP_INFO_TYPE,<sp/>struct.pack(</highlight><highlight class="stringliteral">&quot;&lt;L&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">])).dump()</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exc_regs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>reg_id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>extra_regs:</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exc_regs.extend([reg_id,<sp/>extra_regs[reg_id]])</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_dump_info_notes<sp/>+=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;EXTRA_INFO&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1acca128403cd63b60cf7a9516833705a5" kindref="member">ESP_CORE_DUMP_EXTRA_INFO_TYPE</ref>ESP_CORE_DUMP_EXTRA_INFO_TYPE,</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>struct.pack(</highlight><highlight class="stringliteral">&quot;&lt;%dL&quot;</highlight><highlight class="normal"><sp/>%<sp/>(1<sp/>+<sp/>len(exc_regs)),<sp/>tcb_addr,<sp/>*exc_regs)).dump()</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a160ca3e3f1c01a45d5c74e759a111544" kindref="member">ESP32_COREDUMP_VERSION_BIN_V2</ref>ESP32_COREDUMP_VERSION_BIN_V2:</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;segs_num&apos;</highlight><highlight class="normal">]):</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ab8664943e2dee6a89b9a433dc97e6fdf" kindref="member">ESP32_COREDUMP_MEM_SEG_HDR_SZ</ref>ESP32_COREDUMP_MEM_SEG_HDR_SZ)</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>+=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ab8664943e2dee6a89b9a433dc97e6fdf" kindref="member">ESP32_COREDUMP_MEM_SEG_HDR_SZ</ref>ESP32_COREDUMP_MEM_SEG_HDR_SZ</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mem_start,mem_sz<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a7e91e226676898d4b11e91f3bcc90d05" kindref="member">ESP32_COREDUMP_MEM_SEG_HDR_FMT</ref>ESP32_COREDUMP_MEM_SEG_HDR_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Read<sp/>memory<sp/>segment<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(mem_sz,<sp/>mem_start))</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(core_off,<sp/>stack_len_aligned)</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(mem_start,<sp/>data,<sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ESPCoreDumpSegment.PF_R<sp/>|<sp/>ESPCoreDumpSegment.PF_W)</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_off<sp/>+=<sp/>mem_sz</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>notes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_aux_segment(notes,<sp/>ESPCoreDumpElfFile.PT_NOTE,<sp/>0)</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>NOTES<sp/>segment<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(len(notes),<sp/>0,<sp/>e))</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>core<sp/>dump<sp/>info<sp/>notes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_aux_segment(core_dump_info_notes,<sp/>ESPCoreDumpElfFile.PT_NOTE,<sp/>0)</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>core<sp/>dump<sp/>info<sp/>NOTES<sp/>segment<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(len(core_dump_info_notes),<sp/>0,<sp/>e))</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_aux_segment(task_info_notes,<sp/>ESPCoreDumpElfFile.PT_NOTE,<sp/>0)</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>failed<sp/>tasks<sp/>info<sp/>NOTES<sp/>segment<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(len(task_info_notes),<sp/>0,<sp/>e))</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>add<sp/>ROM<sp/>text<sp/>sections</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rom_elf:</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ps<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rom_elf.program_segments:</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ps.flags<sp/>&amp;<sp/>ESPCoreDumpSegment.PF_X)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.add_program_segment(ps.addr,<sp/>ps.data,<sp/>ESPCoreDumpElfFile.PT_LOAD,<sp/>ps.flags)</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Skip<sp/>ROM<sp/>segment<sp/>%d<sp/>bytes<sp/>@<sp/>0x%x.<sp/>(Reason:<sp/>%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(len(ps.data),<sp/>ps.addr,<sp/>e))</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>dump<sp/>core<sp/>ELF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.e_type<sp/>=<sp/>ESPCoreDumpElfFile.ET_CORE</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.e_machine<sp/>=<sp/>ESPCoreDumpElfFile.EM_XTENSA</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_elf.dump(fce)</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>core_fname</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887" refid="classespcoredump_1_1ESPCoreDumpLoader_1afca16b7ad4d1431b9467403991a48a10" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1afca16b7ad4d1431b9467403991a48a10" kindref="member">create_corefile</ref>(self,<sp/>core_fname=None,<sp/>exe_name=None,<sp/>rom_elf=None,<sp/>off=0):</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Creates<sp/>core<sp/>dump<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="889"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(off,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9e31b52b940437262bf2aed5c6ff0f31" kindref="member">ESP32_COREDUMP_HDR_SZ</ref>ESP32_COREDUMP_HDR_SZ)</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vals<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ad27f1645c797b5456163cc2dd3021cdb" kindref="member">ESP32_COREDUMP_HDR_FMT</ref>ESP32_COREDUMP_HDR_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr<sp/>=<sp/>dict(zip((</highlight><highlight class="stringliteral">&apos;tot_len&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;task_num&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;tcbsz&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;segs_num&apos;</highlight><highlight class="normal">),<sp/>vals))</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>core_fname:</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fce<sp/>=<sp/>tempfile.NamedTemporaryFile(mode=</highlight><highlight class="stringliteral">&apos;w+b&apos;</highlight><highlight class="normal">,<sp/>delete=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>fce.name</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ae16fc3f143565d47ab88c16c847b0927" kindref="member">ESP32_COREDUMP_VERSION_ELF_CRC32</ref>ESP32_COREDUMP_VERSION_ELF_CRC32<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a5111917e2e17fbd5a710cc81b98f3ce8" kindref="member">ESP32_COREDUMP_VERSION_ELF_SHA256</ref>ESP32_COREDUMP_VERSION_ELF_SHA256:</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a536e5e7ca863d8dbc6a7a4a465064ac3" kindref="member">_extract_elf_corefile</ref>_extract_elf_corefile(core_fname,<sp/>off<sp/>+<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9e31b52b940437262bf2aed5c6ff0f31" kindref="member">ESP32_COREDUMP_HDR_SZ</ref>ESP32_COREDUMP_HDR_SZ,<sp/>exe_name)</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a160ca3e3f1c01a45d5c74e759a111544" kindref="member">ESP32_COREDUMP_VERSION_BIN_V2</ref>ESP32_COREDUMP_VERSION_BIN_V2:</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a08c4d26f0680f051fa4c9e9b41423191" kindref="member">_extract_bin_corefile</ref>_extract_bin_corefile(core_fname,<sp/>rom_elf,<sp/>off<sp/>+<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9e31b52b940437262bf2aed5c6ff0f31" kindref="member">ESP32_COREDUMP_HDR_SZ</ref>ESP32_COREDUMP_HDR_SZ)</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a614b9892ad058e67dfe536f58b0a48e5" kindref="member">ESP32_COREDUMP_VERSION_BIN_V1</ref>ESP32_COREDUMP_VERSION_BIN_V1:</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a08c4d26f0680f051fa4c9e9b41423191" kindref="member">_extract_bin_corefile</ref>_extract_bin_corefile(core_fname,<sp/>rom_elf,<sp/>off<sp/>+<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a662c3f998b690c6d182e14a80d700d6c" kindref="member">ESP32_COREDUMP_BIN_V1_HDR_SZ</ref>ESP32_COREDUMP_BIN_V1_HDR_SZ)</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Core<sp/>dump<sp/>version<sp/>&apos;0x%x&apos;<sp/>is<sp/>not<sp/>supported!&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a6cd0e37b51d91af81a0e99e38d1cf268" kindref="member">hdr</ref>hdr[</highlight><highlight class="stringliteral">&apos;ver&apos;</highlight><highlight class="normal">]))</highlight></codeline>
<codeline lineno="903"><highlight class="normal"></highlight></codeline>
<codeline lineno="904" refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>(self,<sp/>off,<sp/>sz):</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>data<sp/>from<sp/>raw<sp/>core<sp/>dump<sp/>got<sp/>from<sp/>flash<sp/>or<sp/>UART</highlight></codeline>
<codeline lineno="906"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref>fcore.seek(off)</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref>fcore.read(sz)</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>data</highlight></codeline>
<codeline lineno="910"><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"></highlight></codeline>
<codeline lineno="912" refid="classespcoredump_1_1ESPCoreDumpFileLoader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader" kindref="compound">ESPCoreDumpFileLoader</ref>(<ref refid="classespcoredump_1_1ESPCoreDumpLoader" kindref="compound">ESPCoreDumpLoader</ref>):</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>file<sp/>loader<sp/>class</highlight></codeline>
<codeline lineno="914"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915" refid="classespcoredump_1_1ESPCoreDumpFileLoader_1a31c4b012d1ae6130ab4ee0a74ea37916" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1a31c4b012d1ae6130ab4ee0a74ea37916" kindref="member">__init__</ref>(self,<sp/>path,<sp/>b64=False):</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>core<sp/>dump<sp/>file<sp/>loader</highlight></codeline>
<codeline lineno="917"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpFileLoader,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1a31c4b012d1ae6130ab4ee0a74ea37916" kindref="member">__init__</ref>()</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1a6040030d75ad2ac95ee6028ae7ebc9c3" kindref="member">fcore</ref>fcore<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1ac326980cfedd2e1a68dee5ac293355ca" kindref="member">_load_coredump</ref>_load_coredump(path,<sp/>b64)</highlight></codeline>
<codeline lineno="920"><highlight class="normal"></highlight></codeline>
<codeline lineno="921" refid="classespcoredump_1_1ESPCoreDumpFileLoader_1ac326980cfedd2e1a68dee5ac293355ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1ac326980cfedd2e1a68dee5ac293355ca" kindref="member">_load_coredump</ref>(self,<sp/>path,<sp/>b64):</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Loads<sp/>core<sp/>dump<sp/>from<sp/>(raw<sp/>binary<sp/>or<sp/>base64-encoded)<sp/>file</highlight></codeline>
<codeline lineno="923"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Load<sp/>core<sp/>dump<sp/>from<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1acf868d3c1f714d850813455e4dd79de4" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>b64:</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fhnd,self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1acf868d3c1f714d850813455e4dd79de4" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/>tempfile.mkstemp()</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcore<sp/>=<sp/>os.fdopen(fhnd,<sp/></highlight><highlight class="stringliteral">&apos;wb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fb64<sp/>=<sp/>open(path,<sp/></highlight><highlight class="stringliteral">&apos;rb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>fb64.readline()</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(line)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>base64.standard_b64decode(line.rstrip(b</highlight><highlight class="stringliteral">&apos;\r\n&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcore.write(data)</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcore.close()</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcore<sp/>=<sp/>open(self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1acf868d3c1f714d850813455e4dd79de4" kindref="member">fcore_name</ref>fcore_name,<sp/></highlight><highlight class="stringliteral">&apos;rb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1acf868d3c1f714d850813455e4dd79de4" kindref="member">fcore_name</ref>fcore_name:</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" kindref="member">remove_tmp_file</ref>remove_tmp_file(self.<ref refid="classespcoredump_1_1ESPCoreDumpFileLoader_1acf868d3c1f714d850813455e4dd79de4" kindref="member">fcore_name</ref>fcore_name)</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>e</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">finally</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fb64.close()</highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fcore<sp/>=<sp/>open(path,<sp/></highlight><highlight class="stringliteral">&apos;rb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>fcore</highlight></codeline>
<codeline lineno="948"><highlight class="normal"></highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950" refid="classespcoredump_1_1ESPCoreDumpFlashLoader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader" kindref="compound">ESPCoreDumpFlashLoader</ref>(<ref refid="classespcoredump_1_1ESPCoreDumpLoader" kindref="compound">ESPCoreDumpLoader</ref>):</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Core<sp/>dump<sp/>flash<sp/>loader<sp/>class</highlight></codeline>
<codeline lineno="952"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_FLASH_LEN_FMT<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;L&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_FLASH_LEN_SZ<sp/><sp/><sp/><sp/><sp/>=<sp/>struct.calcsize(ESP32_COREDUMP_FLASH_LEN_FMT)</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP32_COREDUMP_PART_TABLE_OFF<sp/><sp/><sp/>=<sp/>0x8000</highlight></codeline>
<codeline lineno="956"><highlight class="normal"></highlight></codeline>
<codeline lineno="957" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab4f15a0231682e183c34d11131d6a59b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab4f15a0231682e183c34d11131d6a59b" kindref="member">__init__</ref>(self,<sp/>off,<sp/>tool_path=None,<sp/>chip=&apos;esp32&apos;,<sp/>port=None,<sp/>baud=None):</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>core<sp/>dump<sp/>flash<sp/>loader</highlight></codeline>
<codeline lineno="959"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(ESPCoreDumpFlashLoader,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab4f15a0231682e183c34d11131d6a59b" kindref="member">__init__</ref>()</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port<sp/>=<sp/>port</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a3bbecf6726e09f229f62a6f1a0326c82" kindref="member">baud</ref>baud<sp/>=<sp/>baud</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a104c6d6b4f6cd8bf41e4406f98c7e6ca" kindref="member">chip</ref>chip<sp/>=<sp/>chip</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a99665db2961d46d55fe3ac657f5b9d7f" kindref="member">fcore</ref><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a5dbc997d7e75259e59756eaa948c1929" kindref="member">fcore</ref>fcore<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4788a0409160b3f4a5c3dff895daa6b0" kindref="member">_load_coredump</ref>_load_coredump(off)</highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="967" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a14591cf9ce708c432f7c239370573a97" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a14591cf9ce708c432f7c239370573a97" kindref="member">get_tool_path</ref>(self,<sp/>use_esptool=None):</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Get<sp/>tool<sp/>path</highlight></codeline>
<codeline lineno="969"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>use_esptool:</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/>os.path.join(idf_path,<sp/></highlight><highlight class="stringliteral">&apos;components&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;esptool_py&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;esptool&apos;</highlight><highlight class="normal">)<sp/>+<sp/>os.path.sep</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/>os.path.join(idf_path,<sp/></highlight><highlight class="stringliteral">&apos;components&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;partition_table&apos;</highlight><highlight class="normal">)<sp/>+<sp/>os.path.sep</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tool_path</highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight></codeline>
<codeline lineno="976" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ac826f0b02133ae741a17e06736115255" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ac826f0b02133ae741a17e06736115255" kindref="member">get_core_dump_partition_info</ref>(self,<sp/>part_off=None,<sp/>tool_path=None):</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Get<sp/>core<sp/>dump<sp/>partition<sp/>info<sp/>using<sp/>parttool</highlight></codeline>
<codeline lineno="978"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Retrieving<sp/>core<sp/>dump<sp/>partition<sp/>offset<sp/>and<sp/>size...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>tool_path:</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a14591cf9ce708c432f7c239370573a97" kindref="member">get_tool_path</ref>get_tool_path(use_esptool=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>part_off:</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_off<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a605f7542c04da944dbe637f3c9483d3a" kindref="member">ESP32_COREDUMP_PART_TABLE_OFF</ref>ESP32_COREDUMP_PART_TABLE_OFF</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args<sp/>=<sp/>[sys.executable,<sp/>tool_path<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;parttool.py&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;-q&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;--partition-table-offset&quot;</highlight><highlight class="normal">,<sp/>str(part_off)]</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port:</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args.extend([</highlight><highlight class="stringliteral">&apos;--port&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port])</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invoke_args<sp/>=<sp/>tool_args<sp/>+<sp/>[</highlight><highlight class="stringliteral">&quot;get_partition_info&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;--partition-type&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;data&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;--partition-subtype&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;coredump&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;--info&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;offset&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;size&quot;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(offset_str,<sp/>size_str)<sp/>=<sp/>subprocess.check_output(invoke_args).strip().split(b</highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>int(size_str,<sp/>16)</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>offset<sp/>=<sp/>int(offset_str,<sp/>16)</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Core<sp/>dump<sp/>partition<sp/>offset=%d,<sp/>size=%d&quot;</highlight><highlight class="normal">,<sp/>offset,<sp/>size)</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>subprocess.CalledProcessError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;parttool<sp/>get<sp/>partition<sp/>info<sp/>failed<sp/>with<sp/>err<sp/>%d&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.returncode)</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>ran:<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.cmd)</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>out:&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(e.output)</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>coredump<sp/>partition<sp/>exists<sp/>in<sp/>partition<sp/>table.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>e</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(offset,<sp/>size)</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight></codeline>
<codeline lineno="1004" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a618a7d5d7a5baa15a25ba29971c270f3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a618a7d5d7a5baa15a25ba29971c270f3" kindref="member">invoke_parttool</ref>(self,<sp/>tool_path=None):</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Loads<sp/>core<sp/>dump<sp/>from<sp/>flash<sp/>using<sp/>parttool</highlight></codeline>
<codeline lineno="1006"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_tool_args<sp/>=<sp/>[sys.executable,<sp/>tool_path<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;parttool.py&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port:</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_tool_args.extend([</highlight><highlight class="stringliteral">&apos;--port&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port])</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_tool_args.extend([</highlight><highlight class="stringliteral">&apos;read_partition&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;--partition-type&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;data&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;--partition-subtype&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;coredump&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;--output&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>tempfile.NamedTemporaryFile(mode=</highlight><highlight class="stringliteral">&apos;w+b&apos;</highlight><highlight class="normal">,<sp/>delete=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>part_tool_args.append(f.name)</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/>f.name</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>core<sp/>dump<sp/>partition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>et_out<sp/>=<sp/>subprocess.check_output(part_tool_args)</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(et_out):</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(et_out.decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afbf21da0586c9e418ec7873c9bcb5a84" kindref="member">_read_core_dump_length</ref>_read_core_dump_length(f)</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz)</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cut<sp/>free<sp/>space<sp/>of<sp/>the<sp/>partition</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.truncate()</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(0)</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>subprocess.CalledProcessError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;parttool<sp/>script<sp/>execution<sp/>failed<sp/>with<sp/>err<sp/>%d&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.returncode)</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>ran:<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.cmd)</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>out:&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(e.output)</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name:</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.close()</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" kindref="member">remove_tmp_file</ref>remove_tmp_file(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name)</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>e</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4846df7c9b229b1781c6885525d0327f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4846df7c9b229b1781c6885525d0327f" kindref="member">invoke_esptool</ref>(self,<sp/>tool_path=None,<sp/>off=None):</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Loads<sp/>core<sp/>dump<sp/>from<sp/>flash<sp/>using<sp/>elftool</highlight></codeline>
<codeline lineno="1039"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args<sp/>=<sp/>[sys.executable,<sp/>tool_path<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;esptool.py&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-c&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a104c6d6b4f6cd8bf41e4406f98c7e6ca" kindref="member">chip</ref>chip]</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port:</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args.extend([</highlight><highlight class="stringliteral">&apos;-p&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afc18b5e5167e689b78ae1e96a5338115" kindref="member">port</ref>port])</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a3bbecf6726e09f229f62a6f1a0326c82" kindref="member">baud</ref>baud:</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args.extend([</highlight><highlight class="stringliteral">&apos;-b&apos;</highlight><highlight class="normal">,<sp/>str(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a3bbecf6726e09f229f62a6f1a0326c82" kindref="member">baud</ref>baud)])</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>tempfile.NamedTemporaryFile(mode=</highlight><highlight class="stringliteral">&apos;w+b&apos;</highlight><highlight class="normal">,<sp/>delete=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(part_offset,<sp/>part_size)<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ac826f0b02133ae741a17e06736115255" kindref="member">get_core_dump_partition_info</ref>get_core_dump_partition_info(tool_path=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>off:</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>off<sp/>=<sp/>part_offset<sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>default<sp/>offset<sp/>if<sp/>not<sp/>specified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;The<sp/>core<sp/>dump<sp/>image<sp/>offset<sp/>is<sp/>not<sp/>specified.<sp/>Use<sp/>partition<sp/>offset:<sp/>%d.&quot;</highlight><highlight class="normal">,<sp/>part_offset)</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>part_offset<sp/>!=<sp/>off:</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;Predefined<sp/>image<sp/>offset:<sp/>%d<sp/>does<sp/>not<sp/>match<sp/>core<sp/>dump<sp/>partition<sp/>offset:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>off,<sp/>part_offset)</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args.extend([</highlight><highlight class="stringliteral">&apos;read_flash&apos;</highlight><highlight class="normal">,<sp/>str(off),<sp/>str(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a356b4d121f72298b1689566ea104d0a7" kindref="member">ESP32_COREDUMP_FLASH_LEN_SZ</ref>ESP32_COREDUMP_FLASH_LEN_SZ)])</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args.append(f.name)</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name<sp/>=<sp/>f.name</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>core<sp/>dump<sp/>length</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>et_out<sp/>=<sp/>subprocess.check_output(tool_args)</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(et_out):</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(et_out.decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afbf21da0586c9e418ec7873c9bcb5a84" kindref="member">_read_core_dump_length</ref>_read_core_dump_length(f)</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>==<sp/>0<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>&gt;<sp/>part_size:</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Incorrect<sp/>size<sp/>of<sp/>core<sp/>dump<sp/>image:<sp/>%d,<sp/>use<sp/>partition<sp/>size<sp/>instead:<sp/>%d&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz,<sp/>part_size)</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>=<sp/>part_size</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>actual<sp/>size<sp/>of<sp/>core<sp/>dump<sp/>image<sp/>and<sp/>read<sp/>it<sp/>from<sp/>flash</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_args[-2]<sp/>=<sp/>str(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz)</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>et_out<sp/>=<sp/>subprocess.check_output(tool_args)</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(et_out):</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(et_out.decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>subprocess.CalledProcessError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;esptool<sp/>script<sp/>execution<sp/>failed<sp/>with<sp/>err<sp/>%d&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.returncode)</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>ran:<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>e.cmd)</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Command<sp/>out:&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(e.output)</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name:</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.close()</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a94c03e2dd86a5d13f8698d2290abee4f" kindref="member">remove_tmp_file</ref>remove_tmp_file(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a0b545d30e61030dfce02b62c9d723180" kindref="member">fcore_name</ref>fcore_name)</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>e</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"></highlight></codeline>
<codeline lineno="1081" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4788a0409160b3f4a5c3dff895daa6b0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4788a0409160b3f4a5c3dff895daa6b0" kindref="member">_load_coredump</ref>(self,<sp/>off=None):</highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Loads<sp/>core<sp/>dump<sp/>from<sp/>flash<sp/>using<sp/>parttool<sp/>or<sp/>elftool<sp/>(if<sp/>offset<sp/>is<sp/>set)</highlight></codeline>
<codeline lineno="1083"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>off:</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Invoke<sp/>esptool<sp/>to<sp/>read<sp/>image.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4846df7c9b229b1781c6885525d0327f" kindref="member">invoke_esptool</ref>invoke_esptool(tool_path=tool_path,<sp/>off=off)</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(</highlight><highlight class="stringliteral">&quot;Invoke<sp/>parttool<sp/>to<sp/>read<sp/>image.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a618a7d5d7a5baa15a25ba29971c270f3" kindref="member">invoke_parttool</ref>invoke_parttool(tool_path=tool_path)</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>subprocess.CalledProcessError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(e.output):</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.info(e.output)</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.warning(</highlight><highlight class="stringliteral">&quot;System<sp/>path<sp/>is<sp/>not<sp/>set.<sp/>Try<sp/>to<sp/>use<sp/>predefined<sp/>path.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>off:</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a14591cf9ce708c432f7c239370573a97" kindref="member">get_tool_path</ref>get_tool_path(use_esptool=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a4846df7c9b229b1781c6885525d0327f" kindref="member">invoke_esptool</ref>invoke_esptool(tool_path=tool_path,<sp/>off=off)</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tool_path<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a14591cf9ce708c432f7c239370573a97" kindref="member">get_tool_path</ref>get_tool_path(use_esptool=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a618a7d5d7a5baa15a25ba29971c270f3" kindref="member">invoke_parttool</ref>invoke_parttool(tool_path=tool_path)</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"></highlight></codeline>
<codeline lineno="1106" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afbf21da0586c9e418ec7873c9bcb5a84" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1afbf21da0586c9e418ec7873c9bcb5a84" kindref="member">_read_core_dump_length</ref>(self,<sp/>f):</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Reads<sp/>core<sp/>dump<sp/>length</highlight></codeline>
<codeline lineno="1108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>f.read(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a356b4d121f72298b1689566ea104d0a7" kindref="member">ESP32_COREDUMP_FLASH_LEN_SZ</ref>ESP32_COREDUMP_FLASH_LEN_SZ)</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tot_len,<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a095220957ed745f1bfc0762a24628fdd" kindref="member">ESP32_COREDUMP_FLASH_LEN_FMT</ref>ESP32_COREDUMP_FLASH_LEN_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tot_len</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113" refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a10b562b5ae6a7e7b2da58f3ce2745f99" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a10b562b5ae6a7e7b2da58f3ce2745f99" kindref="member">create_corefile</ref>(self,<sp/>core_fname=None,<sp/>exe_name=None,<sp/>rom_elf=None):</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Checks<sp/>flash<sp/>coredump<sp/>data<sp/>integrity<sp/>and<sp/>creates<sp/>ELF<sp/>file</highlight></codeline>
<codeline lineno="1115"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(0,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a9e31b52b940437262bf2aed5c6ff0f31" kindref="member">ESP32_COREDUMP_HDR_SZ</ref>ESP32_COREDUMP_HDR_SZ)</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a28ef5ab41387ace9f9c00746ddec3595" kindref="member">checksum_len</ref>checksum_len<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_,coredump_ver,_,_,_<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ad27f1645c797b5456163cc2dd3021cdb" kindref="member">ESP32_COREDUMP_HDR_FMT</ref>ESP32_COREDUMP_HDR_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>coredump_ver<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ae16fc3f143565d47ab88c16c847b0927" kindref="member">ESP32_COREDUMP_VERSION_ELF_CRC32</ref>ESP32_COREDUMP_VERSION_ELF_CRC32<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>coredump_ver<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a614b9892ad058e67dfe536f58b0a48e5" kindref="member">ESP32_COREDUMP_VERSION_BIN_V1</ref>ESP32_COREDUMP_VERSION_BIN_V1<sp/>\</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>coredump_ver<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a160ca3e3f1c01a45d5c74e759a111544" kindref="member">ESP32_COREDUMP_VERSION_BIN_V2</ref>ESP32_COREDUMP_VERSION_BIN_V2:</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;Dump<sp/>size<sp/>=<sp/>%d,<sp/>crc<sp/>off<sp/>=<sp/>0x%x&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1aa51808a5f0809bac4da3144f53426269" kindref="member">ESP32_COREDUMP_CRC_SZ</ref>ESP32_COREDUMP_CRC_SZ)</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1aa51808a5f0809bac4da3144f53426269" kindref="member">ESP32_COREDUMP_CRC_SZ</ref>ESP32_COREDUMP_CRC_SZ,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1aa51808a5f0809bac4da3144f53426269" kindref="member">ESP32_COREDUMP_CRC_SZ</ref>ESP32_COREDUMP_CRC_SZ)</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dump_crc,<sp/>=<sp/>struct.unpack_from(self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1ae64ce8d5d520cb13984814e2d9484de5" kindref="member">ESP32_COREDUMP_CRC_FMT</ref>ESP32_COREDUMP_CRC_FMT,<sp/>data)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(0,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1aa51808a5f0809bac4da3144f53426269" kindref="member">ESP32_COREDUMP_CRC_SZ</ref>ESP32_COREDUMP_CRC_SZ)</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_crc<sp/>=<sp/>binascii.crc32(data)<sp/>&amp;<sp/>0xffffffff</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dump_crc<sp/>!=<sp/>data_crc:</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>core<sp/>dump<sp/>CRC<sp/>%x,<sp/>should<sp/>be<sp/>%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(data_crc,<sp/>dump_crc))</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>coredump_ver<sp/>==<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a5111917e2e17fbd5a710cc81b98f3ce8" kindref="member">ESP32_COREDUMP_VERSION_ELF_SHA256</ref>ESP32_COREDUMP_VERSION_ELF_SHA256:</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dump_sha256<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0e45d82c0f357bfc5d497d3b86629abd" kindref="member">ESP32_COREDUMP_SHA256_SZ</ref>ESP32_COREDUMP_SHA256_SZ,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0e45d82c0f357bfc5d497d3b86629abd" kindref="member">ESP32_COREDUMP_SHA256_SZ</ref>ESP32_COREDUMP_SHA256_SZ)</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>=<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a1bca0f2bcf203dc9b6707ed2054f3920" kindref="member">read_data</ref>read_data(0,<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1ab660fb4b23e681765681b0250dbf4db6" kindref="member">dump_sz</ref>dump_sz<sp/>-<sp/>self.<ref refid="classespcoredump_1_1ESPCoreDumpLoader_1a0e45d82c0f357bfc5d497d3b86629abd" kindref="member">ESP32_COREDUMP_SHA256_SZ</ref>ESP32_COREDUMP_SHA256_SZ)</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_sha256<sp/>=<sp/>sha256(data)</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data_sha256_str<sp/>=<sp/>data_sha256.hexdigest()</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dump_sha256_str<sp/>=<sp/>binascii.hexlify(dump_sha256).decode(</highlight><highlight class="stringliteral">&apos;ascii&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dump_sha256_str<sp/>!=<sp/>data_sha256_str:</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/><ref refid="classespcoredump_1_1ESPCoreDumpLoaderError" kindref="compound">ESPCoreDumpLoaderError</ref>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>core<sp/>dump<sp/>SHA256<sp/>&apos;%s&apos;,<sp/>should<sp/>be<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>(dump_sha256_str,<sp/>data_sha256_str))</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>super(ESPCoreDumpFlashLoader,<sp/>self).<ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader_1a10b562b5ae6a7e7b2da58f3ce2745f99" kindref="member">create_corefile</ref>(core_fname,<sp/>exe_name)</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"></highlight></codeline>
<codeline lineno="1139" refid="classespcoredump_1_1GDBMIOutRecordHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutRecordHandler" kindref="compound">GDBMIOutRecordHandler</ref>(object):</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>output<sp/>record<sp/>handler<sp/>base<sp/>class</highlight></codeline>
<codeline lineno="1141"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/>TAG<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight></codeline>
<codeline lineno="1144" refid="classespcoredump_1_1GDBMIOutRecordHandler_1a41423e62daa17212332fbea8f4a8d2a2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a41423e62daa17212332fbea8f4a8d2a2" kindref="member">__init__</ref>(self,<sp/>f,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Base<sp/>constructor<sp/>for<sp/>GDB/MI<sp/>output<sp/>record<sp/>handler</highlight></codeline>
<codeline lineno="1146"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7a7a9de11e959716af4502f29c65323e" kindref="member">verbose</ref>verbose<sp/>=<sp/>verbose</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"></highlight></codeline>
<codeline lineno="1149" refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7d95449e428ce906ad0e1256b4edf857" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7d95449e428ce906ad0e1256b4edf857" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Base<sp/>method<sp/>to<sp/>execute<sp/>GDB/MI<sp/>output<sp/>record<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1151"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7a7a9de11e959716af4502f29c65323e" kindref="member">verbose</ref>verbose:</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;%s.execute:<sp/>[[%s]]&quot;</highlight><highlight class="normal"><sp/>%<sp/>(self.__class__.__name__,<sp/>ln))</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"></highlight></codeline>
<codeline lineno="1156" refid="classespcoredump_1_1GDBMIOutStreamHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutStreamHandler" kindref="compound">GDBMIOutStreamHandler</ref>(<ref refid="classespcoredump_1_1GDBMIOutRecordHandler" kindref="compound">GDBMIOutRecordHandler</ref>):</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>output<sp/>stream<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1158"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1159" refid="classespcoredump_1_1GDBMIOutStreamHandler_1a44c89385ce920defba5e846a98151dda" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1a44c89385ce920defba5e846a98151dda" kindref="member">__init__</ref>(self,<sp/>f,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>GDB/MI<sp/>output<sp/>stream<sp/>handler</highlight></codeline>
<codeline lineno="1161"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(GDBMIOutStreamHandler,<sp/>self).<ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1a44c89385ce920defba5e846a98151dda" kindref="member">__init__</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose)</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1af1b57fceda75d6bdd5185bdb9cfe8145" kindref="member">func</ref>func<sp/>=<sp/>f</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"></highlight></codeline>
<codeline lineno="1165" refid="classespcoredump_1_1GDBMIOutStreamHandler_1a6ed73145bc76452943d4d6983cf770d3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1a6ed73145bc76452943d4d6983cf770d3" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>output<sp/>stream<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1167"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIOutRecordHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1af1b57fceda75d6bdd5185bdb9cfe8145" kindref="member">func</ref>func:</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>remove<sp/>TAG<sp/>/<sp/>quotes<sp/>and<sp/>replace<sp/>c-string<sp/>\n<sp/>with<sp/>actual<sp/>NL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1af1b57fceda75d6bdd5185bdb9cfe8145" kindref="member">func</ref>func(ln[1:].strip(</highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;\\n&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">).replace(</highlight><highlight class="stringliteral">&apos;\\t&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\t&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"></highlight></codeline>
<codeline lineno="1174" refid="classespcoredump_1_1GDBMIResultHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>(<ref refid="classespcoredump_1_1GDBMIOutRecordHandler" kindref="compound">GDBMIOutRecordHandler</ref>):</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>result<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1176"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/>TAG<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/>RC_DONE<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;done&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/>RC_RUNNING<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;running&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/>RC_CONNECTED<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;connected&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/>RC_ERROR<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;error&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/>RC_EXIT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;exit&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184" refid="classespcoredump_1_1GDBMIResultHandler_1a1940366d0ec9f26ef18dce076ca151a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIResultHandler_1a1940366d0ec9f26ef18dce076ca151a6" kindref="member">__init__</ref>(self,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>GDB/MI<sp/>result<sp/>handler</highlight></codeline>
<codeline lineno="1186"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(GDBMIResultHandler,<sp/>self).<ref refid="classespcoredump_1_1GDBMIResultHandler_1a1940366d0ec9f26ef18dce076ca151a6" kindref="member">__init__</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose)</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight></codeline>
<codeline lineno="1191" refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>(self,<sp/>ln,<sp/>rc):</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Parses<sp/>result<sp/>code</highlight></codeline>
<codeline lineno="1193"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc_str<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;{0}{1}&quot;</highlight><highlight class="normal">.format(self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1ac2c7e93a90f3b82de4a5d934029a4fc6" kindref="member">TAG</ref><ref refid="classespcoredump_1_1GDBMIResultHandler_1a2f516d60d6e44e32e78241cc8f232963" kindref="member">TAG</ref>TAG,<sp/>rc)</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>ln.startswith(rc_str):</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>=<sp/>rc</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(ln)<sp/>&gt;<sp/>len(rc_str):</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str<sp/>=<sp/>ln[len(rc_str):]</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str.startswith(</highlight><highlight class="stringliteral">&apos;,&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str<sp/>=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str[1:]</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>result<sp/>format:<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>ln)</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1207"><highlight class="normal"></highlight></codeline>
<codeline lineno="1208" refid="classespcoredump_1_1GDBMIResultHandler_1a9ccd0e3d0f928af570c19ea4da82ee81" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIResultHandler_1a9ccd0e3d0f928af570c19ea4da82ee81" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>result<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIOutRecordHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>_parse_rc(ln,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa854253d43a2799b73c01c967150ae63" kindref="member">RC_DONE</ref>RC_DONE):</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>_parse_rc(ln,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1ac696d22fdc29d9a7e4ba6c48f9a2bb68" kindref="member">RC_RUNNING</ref>RC_RUNNING):</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>_parse_rc(ln,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9851074ae23bbc5d65c4a265fd080078" kindref="member">RC_CONNECTED</ref>RC_CONNECTED):</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>_parse_rc(ln,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a6ff57d5e023fd96a708fa1bab4818c58" kindref="member">RC_ERROR</ref>RC_ERROR):</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afbea928be1f96b76e7cbbc9d955bb1d9" kindref="member">_parse_rc</ref>_parse_rc(ln,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa0ee00ae9c95124c53c9960faf9e6b84" kindref="member">RC_EXIT</ref>RC_EXIT):</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Unknown<sp/>GDB/MI<sp/>result:<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>ln)</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"></highlight></codeline>
<codeline lineno="1224"><highlight class="normal"></highlight></codeline>
<codeline lineno="1225" refid="classespcoredump_1_1GDBMIThreadListIdsHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler" kindref="compound">GDBMIThreadListIdsHandler</ref>(<ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>):</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>thread-list-ids<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1228" refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1abb4c457390809db4964972c637fd93bf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1abb4c457390809db4964972c637fd93bf" kindref="member">__init__</ref>(self,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>GDB/MI<sp/>result<sp/>handler</highlight></codeline>
<codeline lineno="1230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(GDBMIThreadListIdsHandler,<sp/>self).<ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1abb4c457390809db4964972c637fd93bf" kindref="member">__init__</ref>(verbose)</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1affd5de78888d4065e12bcf4d2b574025" kindref="member">threads</ref>threads<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1a3d376d8a0ff36ee9f557bf24ebb998ea" kindref="member">current_thread</ref>current_thread<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1234"><highlight class="normal"></highlight></codeline>
<codeline lineno="1235" refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1a604b59771813c628fdee6554612028bb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1a604b59771813c628fdee6554612028bb" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>thread-list-ids<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1237"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIResultHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa854253d43a2799b73c01c967150ae63" kindref="member">RC_DONE</ref>RC_DONE:</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>simple<sp/>parsing<sp/>method</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;thread-ids\s*=\s*\{([^\{\}]*)\}&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>tid<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>re.finditer(</highlight><highlight class="stringliteral">r&apos;thread-id=&quot;(\d+)&quot;&apos;</highlight><highlight class="normal">,<sp/>result.group(1)):</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1affd5de78888d4065e12bcf4d2b574025" kindref="member">threads</ref>threads.append(tid.group(1))</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;current-thread-id=&quot;(\d+)&quot;&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler_1a3d376d8a0ff36ee9f557bf24ebb998ea" kindref="member">current_thread</ref>current_thread<sp/>=<sp/>result.group(1)</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"></highlight></codeline>
<codeline lineno="1251" refid="classespcoredump_1_1GDBMIThreadSelectHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadSelectHandler" kindref="compound">GDBMIThreadSelectHandler</ref>(<ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>):</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>thread-select<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1254" refid="classespcoredump_1_1GDBMIThreadSelectHandler_1a720a18f801b88f2f9cfc3c1f62932052" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadSelectHandler_1a720a18f801b88f2f9cfc3c1f62932052" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>thread-select<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1256"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIResultHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa854253d43a2799b73c01c967150ae63" kindref="member">RC_DONE</ref>RC_DONE:</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262" refid="classespcoredump_1_1GDBMIThreadInfoHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadInfoHandler" kindref="compound">GDBMIThreadInfoHandler</ref>(<ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>):</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>thread-info<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1264"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265" refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a99241aef1aba114808aa3cf6cf5e8fdf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a99241aef1aba114808aa3cf6cf5e8fdf" kindref="member">__init__</ref>(self,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>GDB/MI<sp/>result<sp/>handler</highlight></codeline>
<codeline lineno="1267"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(GDBMIThreadInfoHandler,<sp/>self).<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a99241aef1aba114808aa3cf6cf5e8fdf" kindref="member">__init__</ref>(verbose)</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1ae1ded3bae101d61634b79ff3734521da" kindref="member">current</ref>current<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1aaa5790daae23b1c3a7cd6d5edccb3a94" kindref="member">id</ref>id<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a9c51838fed715dc30d82d33927c5bb79" kindref="member">target_id</ref>target_id<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a31178c7e98fda12b59ea79bde5472a0b" kindref="member">details</ref>details<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a93ab385863ae36f447ad1ead8830136c" kindref="member">name</ref>name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1ad5fb4ebfdb191c9f6fe769334d85fbfc" kindref="member">frame</ref>frame<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a4c8ef9ed4b0bea8a3cc8c911e70a1919" kindref="member">state</ref>state<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a3efd77e4d8c14f4c43d71d7488f039f0" kindref="member">core</ref>core<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"></highlight></codeline>
<codeline lineno="1278" refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a0e631c409e1683a378ca136f6907694c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a0e631c409e1683a378ca136f6907694c" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>thread-info<sp/><sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1280"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIResultHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa854253d43a2799b73c01c967150ae63" kindref="member">RC_DONE</ref>RC_DONE:</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>simple<sp/>parsing<sp/>method</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;id=&quot;(\d+)&quot;&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1aaa5790daae23b1c3a7cd6d5edccb3a94" kindref="member">id</ref>id<sp/>=<sp/>result.group(1)</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;current=&quot;\*&quot;&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1ae1ded3bae101d61634b79ff3734521da" kindref="member">current</ref>current<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;target-id=&quot;([^&quot;]+)&quot;&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIThreadInfoHandler_1a9c51838fed715dc30d82d33927c5bb79" kindref="member">target_id</ref>target_id<sp/>=<sp/>result.group(1)</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"></highlight></codeline>
<codeline lineno="1296" refid="classespcoredump_1_1GDBMIDataEvalHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIDataEvalHandler" kindref="compound">GDBMIDataEvalHandler</ref>(<ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>):</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>data-evaluate-expression<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1298"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1299" refid="classespcoredump_1_1GDBMIDataEvalHandler_1a1bb4da2a4afe8f6c547f0ff0b4c362b7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1a1bb4da2a4afe8f6c547f0ff0b4c362b7" kindref="member">__init__</ref>(self,<sp/>verbose=False):</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Constructor<sp/>for<sp/>GDB/MI<sp/>result<sp/>handler</highlight></codeline>
<codeline lineno="1301"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super(GDBMIDataEvalHandler,<sp/>self).<ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1a1bb4da2a4afe8f6c547f0ff0b4c362b7" kindref="member">__init__</ref>(verbose)</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1ada468632bf994a692d75573aed56d2b0" kindref="member">value</ref>value<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"></highlight></codeline>
<codeline lineno="1305" refid="classespcoredump_1_1GDBMIDataEvalHandler_1a702f408bd230977b47ae3e22224e347d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1a702f408bd230977b47ae3e22224e347d" kindref="member">execute</ref>(self,<sp/>ln):</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Executes<sp/>GDB/MI<sp/>data-evaluate-expression<sp/>handler<sp/>function</highlight></codeline>
<codeline lineno="1307"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>GDBMIResultHandler.execute(self,<sp/>ln)</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1a9c362af9be44ec0231d42b1de020f180" kindref="member">result_class</ref>result_class<sp/>!=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1aa854253d43a2799b73c01c967150ae63" kindref="member">RC_DONE</ref>RC_DONE:</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>simple<sp/>parsing<sp/>method</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7a7a9de11e959716af4502f29c65323e" kindref="member">verbose</ref>verbose:</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;GDBMIDataEvalHandler:<sp/>result<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal">,<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;([a-zA-Z_]+)=(.+)\,&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>=<sp/>r.search(self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str,<sp/>pos=pos)</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>m:</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>m.group(1)<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;value&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7a7a9de11e959716af4502f29c65323e" kindref="member">verbose</ref>verbose:</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;GDBMIDataEvalHandler:<sp/>found<sp/>value<sp/>=<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal">,<sp/>m.group(2))</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1ada468632bf994a692d75573aed56d2b0" kindref="member">value</ref>value<sp/>=<sp/>self.result.group(1)</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos<sp/>=<sp/>m.end(2)<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res_str<sp/>=<sp/>self.<ref refid="classespcoredump_1_1GDBMIResultHandler_1afaf27befe052ba372762b8ca32c2f71e" kindref="member">result_str</ref>result_str[pos:]</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res_str<sp/>=<sp/>res_str.replace(</highlight><highlight class="stringliteral">r&apos;\&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m<sp/>=<sp/>re.search(</highlight><highlight class="stringliteral">r&apos;value=&quot;([^&quot;]+)&quot;&apos;</highlight><highlight class="normal">,<sp/>res_str)</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>m:</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classespcoredump_1_1GDBMIOutRecordHandler_1a7a7a9de11e959716af4502f29c65323e" kindref="member">verbose</ref>verbose:</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.debug(</highlight><highlight class="stringliteral">&quot;GDBMIDataEvalHandler:<sp/>found<sp/>value<sp/>=<sp/>&apos;%s&apos;&quot;</highlight><highlight class="normal">,<sp/>m.group(1))</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classespcoredump_1_1GDBMIDataEvalHandler_1ada468632bf994a692d75573aed56d2b0" kindref="member">value</ref>value<sp/>=<sp/>m.group(1)</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"></highlight></codeline>
<codeline lineno="1334"><highlight class="normal"></highlight></codeline>
<codeline lineno="1335" refid="classespcoredump_1_1GDBMIStreamConsoleHandler" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(<ref refid="classespcoredump_1_1GDBMIOutStreamHandler" kindref="compound">GDBMIOutStreamHandler</ref>):</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;GDB/MI<sp/>console<sp/>stream<sp/>handler<sp/>class</highlight></codeline>
<codeline lineno="1337"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/>TAG<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;~&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"></highlight></codeline>
<codeline lineno="1340"><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">load_aux_elf(elf_path):</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Loads<sp/>auxilary<sp/>ELF<sp/>file<sp/>and<sp/>composes<sp/>GDB<sp/>command<sp/>to<sp/>read<sp/>its<sp/>symbols</highlight></codeline>
<codeline lineno="1343"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/>elf<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/>sym_cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>os.path.exists(elf_path):</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>(elf_path)</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>elf.sections:</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>s.name<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;.text&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sym_cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;add-symbol-file<sp/>%s<sp/>0x%x&apos;</highlight><highlight class="normal"><sp/>%<sp/>(elf_path,<sp/>s.addr)</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(elf,<sp/>sym_cmd)</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"></highlight></codeline>
<codeline lineno="1353"><highlight class="normal"></highlight></codeline>
<codeline lineno="1354"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">dbg_corefile(args):</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Command<sp/>to<sp/>load<sp/>core<sp/>dump<sp/>from<sp/>file<sp/>or<sp/>flash<sp/>and<sp/>run<sp/>GDB<sp/>debug<sp/>session<sp/>with<sp/>it</highlight></codeline>
<codeline lineno="1356"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">global</highlight><highlight class="normal"><sp/>CLOSE_FDS</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/>loader<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/>rom_elf,rom_sym_cmd<sp/>=<sp/>load_aux_elf(args.rom_elf)</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.core:</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader" kindref="compound">ESPCoreDumpFlashLoader</ref>(args.off,<sp/>port=args.port,<sp/>baud=args.baud)</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>loader.create_corefile(args.save_core,<sp/>exe_name=args.prog,<sp/>rom_elf=rom_elf)</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>core_fname:</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>create<sp/>corefile!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>args.core</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args.core_format<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>args.core_format<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader" kindref="compound">ESPCoreDumpFileLoader</ref>(core_fname,<sp/>args.core_format<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;b64&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>loader.create_corefile(args.save_core,<sp/>exe_name=args.prog,<sp/>rom_elf=rom_elf)</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>core_fname:</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>create<sp/>corefile!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1376"><highlight class="normal"></highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>subprocess.Popen(bufsize=0,</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args=[args.gdb,</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--nw&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>ignore<sp/>.gdbinit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--core=%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>core_fname,<sp/><sp/></highlight><highlight class="comment">#<sp/>core<sp/>file,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;-ex&apos;</highlight><highlight class="normal">,<sp/>rom_sym_cmd,</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args.prog</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>],</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stdin=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>stdout=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>stderr=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close_fds=CLOSE_FDS</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/>p.wait()</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>loader:</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.core<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.save_core:</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.remove_tmp_file(core_fname)</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;Done!&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1394"><highlight class="normal"></highlight></codeline>
<codeline lineno="1395"><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">info_corefile(args):</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;<sp/>Command<sp/>to<sp/>load<sp/>core<sp/>dump<sp/>from<sp/>file<sp/>or<sp/>flash<sp/>and<sp/>print<sp/>it&apos;s<sp/>data<sp/>in<sp/>user<sp/>friendly<sp/>form</highlight></codeline>
<codeline lineno="1398"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">global</highlight><highlight class="normal"><sp/>CLOSE_FDS</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"></highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_console_stream_handler(ln):</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.stdout.write(ln)</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.stdout.flush()</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"></highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_read2prompt(f,<sp/>out_handlers=None):</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ln<sp/>=<sp/>f.readline().decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">).rstrip(</highlight><highlight class="stringliteral">&apos;<sp/>\r\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ln<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;(gdb)&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>len(ln)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>out_handlers:</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>h<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>out_handlers:</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ln.startswith(out_handlers[h].TAG):</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>out_handlers[h].<ref refid="classespcoredump_1_1GDBMIOutStreamHandler_1a6ed73145bc76452943d4d6983cf770d3" kindref="member">execute</ref>(ln)</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1417"><highlight class="normal"></highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_start(handlers,<sp/>gdb_cmds):</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gdb_args<sp/>=<sp/>[args.gdb,</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--quiet&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>inhibit<sp/>dumping<sp/>info<sp/>at<sp/>start-up</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--nx&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>inhibit<sp/>window<sp/>interface</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--nw&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>ignore<sp/>.gdbinit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--interpreter=mi2&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>use<sp/>GDB/MI<sp/>v2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--core=%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>core_fname]<sp/><sp/></highlight><highlight class="comment">#<sp/>core<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>c<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>gdb_cmds:</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gdb_args<sp/>+=<sp/>[</highlight><highlight class="stringliteral">&apos;-ex&apos;</highlight><highlight class="normal">,<sp/>c]</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gdb_args.append(args.prog)</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>subprocess.Popen(bufsize=0,</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args=gdb_args,</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stdin=subprocess.PIPE,<sp/>stdout=subprocess.PIPE,<sp/>stderr=subprocess.STDOUT,</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close_fds=CLOSE_FDS)</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gdbmi_read2prompt(p.stdout,<sp/>handlers)</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"></highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_cmd_exec(p,<sp/>handlers,<sp/>gdbmi_cmd):</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>t<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>handlers:</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[t].result_class<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p.stdin.write(bytearray(</highlight><highlight class="stringliteral">&quot;%s\n&quot;</highlight><highlight class="normal"><sp/>%<sp/>gdbmi_cmd,<sp/>encoding=</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gdbmi_read2prompt(p.stdout,<sp/>handlers)</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>handlers[GDBMIResultHandler.TAG].result_class<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>handlers[GDBMIResultHandler.TAG].result_class<sp/>==<sp/>GDBMIResultHandler.RC_EXIT:</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;GDB<sp/>exited<sp/>(%s<sp/>/<sp/>%s)!&quot;</highlight><highlight class="normal"><sp/>%<sp/>(handlers[GDBMIResultHandler.TAG].result_class,<sp/>handlers[GDBMIResultHandler.TAG].result_str))</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p.wait()</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Problem<sp/>occured!<sp/>GDB<sp/>exited,<sp/>restart<sp/>it.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_start(handlers,<sp/>[])</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>handlers[GDBMIResultHandler.TAG].result_class<sp/>!=<sp/>GDBMIResultHandler.RC_DONE:</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;GDB/MI<sp/>command<sp/>failed<sp/>(%s<sp/>/<sp/>%s)!&quot;</highlight><highlight class="normal"><sp/>%<sp/>(handlers[GDBMIResultHandler.TAG].result_class,<sp/>handlers[GDBMIResultHandler.TAG].result_str))</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_getinfo(p,<sp/>handlers,<sp/>gdb_cmd):</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>gdbmi_cmd_exec(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;-interpreter-exec<sp/>console<sp/>\&quot;%s\&quot;&quot;</highlight><highlight class="normal"><sp/>%<sp/>gdb_cmd)</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"></highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_get_thread_ids(p):</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIThreadListIdsHandler" kindref="compound">GDBMIThreadListIdsHandler</ref>(verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG]<sp/>=<sp/>result</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_cmd_exec(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;-thread-list-ids&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p,result.threads,result.current_thread</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_switch_thread(p,<sp/>thr_id):</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIThreadSelectHandler" kindref="compound">GDBMIThreadSelectHandler</ref>(verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG]<sp/>=<sp/>result</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>gdbmi_cmd_exec(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;-thread-select<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>thr_id)</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_get_thread_info(p,<sp/>thr_id):</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIThreadInfoHandler" kindref="compound">GDBMIThreadInfoHandler</ref>(verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG]<sp/>=<sp/>result</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>thr_id:</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;-thread-info<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>thr_id</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cmd<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;-thread-info&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_cmd_exec(p,<sp/>handlers,<sp/>cmd)</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p,result</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_data_evaluate_expression(p,<sp/>expr):</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIDataEvalHandler" kindref="compound">GDBMIDataEvalHandler</ref>(verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG]<sp/>=<sp/>result</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_cmd_exec(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;-data-evaluate-expression<sp/>\&quot;%s\&quot;&quot;</highlight><highlight class="normal"><sp/>%<sp/>expr)</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p,result</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"></highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdbmi_freertos_get_task_name(p,<sp/>tcb_addr):</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p,res<sp/>=<sp/>gdbmi_data_evaluate_expression(p,<sp/></highlight><highlight class="stringliteral">&quot;(char*)((TCB_t<sp/>*)0x%x)-&gt;pcTaskName&quot;</highlight><highlight class="normal"><sp/>%<sp/>tcb_addr)</highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>re.match(</highlight><highlight class="stringliteral">&quot;0x[a-fA-F0-9]+[^&apos;]*&apos;([^&apos;]*)&apos;&quot;</highlight><highlight class="normal">,<sp/>res.value)</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p,result.group(1)</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>p,</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"></highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gdb2freertos_thread_id(gdb_thread_id):</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>int(gdb_thread_id.replace(</highlight><highlight class="stringliteral">&quot;process<sp/>&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">),<sp/>0)</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"></highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/>loader<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/>rom_elf,rom_sym_cmd<sp/>=<sp/>load_aux_elf(args.rom_elf)</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.core:</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpFlashLoader" kindref="compound">ESPCoreDumpFlashLoader</ref>(args.off,<sp/>port=args.port,<sp/>baud=args.baud)</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>loader.create_corefile(args.save_core,<sp/>exe_name=args.prog,<sp/>rom_elf=rom_elf)</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>core_fname:</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>create<sp/>corefile!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>args.core</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args.core_format<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>args.core_format<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpFileLoader" kindref="compound">ESPCoreDumpFileLoader</ref>(core_fname,<sp/>args.core_format<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;b64&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_fname<sp/>=<sp/>loader.create_corefile(args.save_core,<sp/>exe_name=args.prog,<sp/>rom_elf=rom_elf)</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>core_fname:</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logging.error(</highlight><highlight class="stringliteral">&quot;Failed<sp/>to<sp/>create<sp/>corefile!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1515"><highlight class="normal"></highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/>exe_elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>(args.prog)</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/>core_elf<sp/>=<sp/><ref refid="classespcoredump_1_1ESPCoreDumpElfFile" kindref="compound">ESPCoreDumpElfFile</ref>(core_fname)</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/>merged_segs<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/>core_segs<sp/>=<sp/>core_elf.program_segments</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>exe_elf.sections:</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ps<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>core_segs:</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ps.addr<sp/>&lt;=<sp/>s.addr<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>ps.addr<sp/>+<sp/>len(ps.data)<sp/>&gt;=<sp/>s.addr:</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/><sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/>|...XXX.............|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_addr<sp/>=<sp/>ps.addr</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ps.addr<sp/>+<sp/>len(ps.data)<sp/>&lt;=<sp/>s.addr<sp/>+<sp/>len(s.data):</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/><sp/><sp/><sp/>|XXXXXXXXXXX...|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>merged:<sp/>|XXXXXXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_len<sp/>=<sp/>len(s.data)<sp/>+<sp/>(s.addr<sp/>-<sp/>ps.addr)</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/><sp/><sp/><sp/>|XXXXXXXXXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>merged:<sp/>|XXXXXXXXXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_len<sp/>=<sp/>len(ps.data)</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged_segs.append((s.name,<sp/>seg_addr,<sp/>seg_len,<sp/>s.attr_str(),<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_segs.remove(ps)</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>ps.addr<sp/>&gt;=<sp/>s.addr<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>ps.addr<sp/>&lt;=<sp/>s.addr<sp/>+<sp/>len(s.data):</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/><sp/>|...XXX.............|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_addr<sp/>=<sp/>s.addr</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ps.addr<sp/>+<sp/>len(ps.data))<sp/>&gt;=<sp/>(s.addr<sp/>+<sp/>len(s.data)):</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/><sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/><sp/><sp/><sp/>|..XXXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>merged:<sp/>|XXXXXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_len<sp/>=<sp/>len(s.data)<sp/>+<sp/>(ps.addr<sp/>+<sp/>len(ps.data))<sp/>-<sp/>(s.addr<sp/>+<sp/>len(s.data))</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>sec:<sp/><sp/><sp/><sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>seg:<sp/><sp/><sp/><sp/><sp/><sp/>|XXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>merged:<sp/>|XXXXXXXXXX|</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_len<sp/>=<sp/>len(s.data)</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged_segs.append((s.name,<sp/>seg_addr,<sp/>seg_len,<sp/>s.attr_str(),<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>core_segs.remove(ps)</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1557"><highlight class="normal"></highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>merged:</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>merged_segs.append((s.name,<sp/>s.addr,<sp/>len(s.data),<sp/>s.attr_str(),<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"></highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/>handlers<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIResultHandler" kindref="compound">GDBMIResultHandler</ref>(verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG]<sp/>=<sp/><ref refid="classespcoredump_1_1GDBMIStreamConsoleHandler" kindref="compound">GDBMIStreamConsoleHandler</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>verbose=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_start(handlers,<sp/>[rom_sym_cmd])</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/>extra_note<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/>task_info<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>seg<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>core_elf.aux_segments:</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>seg.type<sp/>!=<sp/>ESPCoreDumpElfFile.PT_NOTE:</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_read<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>note_read<sp/>&lt;<sp/>len(seg.data):</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note<sp/>=<sp/><ref refid="classespcoredump_1_1Elf32NoteDesc" kindref="compound">Elf32NoteDesc</ref>(</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>0,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_read<sp/>+=<sp/>note.read(seg.data[note_read:])</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>note.type<sp/>==<sp/>ESPCoreDumpLoader.ESP_CORE_DUMP_EXTRA_INFO_TYPE<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;EXTRA_INFO&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>note.name:</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_note<sp/>=<sp/>note</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>note.type<sp/>==<sp/>ESPCoreDumpLoader.ESP_CORE_DUMP_TASK_INFO_TYPE<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;TASK_INFO&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>note.name:</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info_struct<sp/>=<sp/><ref refid="classespcoredump_1_1EspCoreDumpTaskStatus" kindref="compound">EspCoreDumpTaskStatus</ref>(buf=note.desc)</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info.append(task_info_struct)</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;===============================================================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;====================<sp/>ESP32<sp/>CORE<sp/>DUMP<sp/>START<sp/>====================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"></highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/>handlers[GDBMIResultHandler.TAG].result_class<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/>handlers[GDBMIStreamConsoleHandler.TAG].func<sp/>=<sp/>gdbmi_console_stream_handler</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>extra_note:</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extra_info<sp/>=<sp/>struct.unpack(</highlight><highlight class="stringliteral">&quot;&lt;%dL&quot;</highlight><highlight class="normal"><sp/>%<sp/>(len(extra_note.desc)<sp/>/<sp/>struct.calcsize(</highlight><highlight class="stringliteral">&quot;&lt;L&quot;</highlight><highlight class="normal">)),<sp/>extra_note.desc)</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>extra_info[0]<sp/>==<sp/>ESPCoreDumpLoader.ESP_COREDUMP_CURR_TASK_MARKER:</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\nCrashed<sp/>task<sp/>has<sp/>been<sp/>skipped.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p,task_name<sp/>=<sp/>gdbmi_freertos_get_task_name(p,<sp/>extra_info[0])</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\nCrashed<sp/>task<sp/>handle:<sp/>0x%x,<sp/>name:<sp/>&apos;%s&apos;,<sp/>GDB<sp/>name:<sp/>&apos;process<sp/>%d&apos;&quot;</highlight><highlight class="normal"><sp/>%<sp/>(extra_info[0],<sp/>task_name,<sp/>extra_info[0]))</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n==================<sp/>CURRENT<sp/>THREAD<sp/>REGISTERS<sp/>===================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>extra_note:</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exccause<sp/>=<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EXCCAUSE_IDX<sp/>+<sp/>1]</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exccause_str<sp/>=<sp/>xtensa_exception_cause_dict.get(exccause)</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>exccause_str:</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exccause_str<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;Invalid<sp/>EXCCAUSE<sp/>code&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>EXCAUSE<sp/>description<sp/>or<sp/>not<sp/>found.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;exccause<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x<sp/>(%s)&quot;</highlight><highlight class="normal"><sp/>%<sp/>(exccause,<sp/>exccause_str[0]))</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;excvaddr<sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EXCVADDR_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC1_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC2_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC3_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc4<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC4_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc5<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC5_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc6<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC6_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;epc7<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPC7_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS2_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS3_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps4<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS4_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps5<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS5_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps6<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS6_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;eps7<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>extra_info[1<sp/>+<sp/>2<sp/>*<sp/>ESPCoreDumpElfFile.REG_EPS7_IDX<sp/>+<sp/>1])</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Exception<sp/>registers<sp/>have<sp/>not<sp/>been<sp/>found!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_getinfo(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;info<sp/>registers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n====================<sp/>CURRENT<sp/>THREAD<sp/>STACK<sp/>=====================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_getinfo(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;bt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>task_info<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>task_info[0].task_flags<sp/>!=<sp/>EspCoreDumpTaskStatus.TASK_STATUS_CORRECT:</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;The<sp/>current<sp/>crashed<sp/>task<sp/>is<sp/>corrupted.&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Task<sp/>#%d<sp/>info:<sp/>flags,<sp/>tcb,<sp/>stack<sp/>(%x,<sp/>%x,<sp/>%x).&quot;</highlight><highlight class="normal"><sp/>%<sp/>(task_info[0].task_index,</highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[0].task_flags,</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[0].task_tcb_addr,</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[0].task_stack_start))</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n========================<sp/>THREADS<sp/>INFO<sp/>=========================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_getinfo(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;info<sp/>threads&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>THREADS<sp/>STACKS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/>p,threads,cur_thread<sp/>=<sp/>gdbmi_get_thread_ids(p)</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>thr_id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>threads:</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_index<sp/>=<sp/>int(thr_id)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>thr_id<sp/>==<sp/>cur_thread:</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_switch_thread(p,<sp/>thr_id)</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p,thr_info_res<sp/>=<sp/>gdbmi_get_thread_info(p,<sp/>thr_id)</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tcb_addr<sp/>=<sp/>gdb2freertos_thread_id(thr_info_res.target_id)</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p,task_name<sp/>=<sp/>gdbmi_freertos_get_task_name(p,<sp/>tcb_addr)</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n====================<sp/>THREAD<sp/>%s<sp/>(TCB:<sp/>0x%x,<sp/>name:<sp/>&apos;%s&apos;)<sp/>=====================&quot;</highlight><highlight class="normal"><sp/>%<sp/>(thr_id,<sp/>tcb_addr,<sp/>task_name))</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_getinfo(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;bt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>task_info<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>task_info[task_index].task_flags<sp/>!=<sp/>EspCoreDumpTaskStatus.TASK_STATUS_CORRECT:</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;The<sp/>task<sp/>&apos;%s&apos;<sp/>is<sp/>corrupted.&quot;</highlight><highlight class="normal"><sp/>%<sp/>thr_id)</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Task<sp/>#%d<sp/>info:<sp/>flags,<sp/>tcb,<sp/>stack<sp/>(%x,<sp/>%x,<sp/>%x).&quot;</highlight><highlight class="normal"><sp/>%<sp/>(task_info[task_index].task_index,</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[task_index].task_flags,</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[task_index].task_tcb_addr,</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>task_info[task_index].task_stack_start))</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n=======================<sp/>ALL<sp/>MEMORY<sp/>REGIONS<sp/>========================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;Name<sp/><sp/><sp/>Address<sp/><sp/><sp/>Size<sp/><sp/><sp/>Attrs&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ms<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>merged_segs:</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;%s<sp/>0x%x<sp/>0x%x<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(ms[0],<sp/>ms[1],<sp/>ms[2],<sp/>ms[3]))</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cs<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>core_segs:</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>core<sp/>dump<sp/>exec<sp/>segments<sp/>are<sp/>from<sp/>ROM,<sp/>other<sp/>are<sp/>belong<sp/>to<sp/>tasks<sp/>(TCB<sp/>or<sp/>stack)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>cs.flags<sp/>&amp;<sp/>ESPCoreDumpSegment.PF_X:</highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;rom.text&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;tasks.data&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;.coredump.%s<sp/>0x%x<sp/>0x%x<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(seg_name,<sp/>cs.addr,<sp/>len(cs.data),<sp/>cs.attr_str()))</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args.print_mem:</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n======================<sp/>CORE<sp/>DUMP<sp/>MEMORY<sp/>CONTENTS<sp/>========================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cs<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>core_elf.program_segments:</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>core<sp/>dump<sp/>exec<sp/>segments<sp/>are<sp/>from<sp/>ROM,<sp/>other<sp/>are<sp/>belong<sp/>to<sp/>tasks<sp/>(TCB<sp/>or<sp/>stack)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>cs.flags<sp/>&amp;<sp/>ESPCoreDumpSegment.PF_X:</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;rom.text&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;tasks.data&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;.coredump.%s<sp/>0x%x<sp/>0x%x<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(seg_name,<sp/>cs.addr,<sp/>len(cs.data),<sp/>cs.attr_str()))</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>gdbmi_getinfo(p,<sp/>handlers,<sp/></highlight><highlight class="stringliteral">&quot;x/%dx<sp/>0x%x&quot;</highlight><highlight class="normal"><sp/>%<sp/>(old_div(len(cs.data),4),<sp/>cs.addr))</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"></highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;\n=====================<sp/>ESP32<sp/>CORE<sp/>DUMP<sp/>END<sp/>=====================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;===============================================================&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"></highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/>p.stdin.write(b</highlight><highlight class="stringliteral">&apos;q\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/>p.wait()</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/>p.stdin.close()</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/>p.stdout.close()</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"></highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>loader:</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.core<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args.save_core:</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.remove_tmp_file(core_fname)</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>loader.cleanup()</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;Done!&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"></highlight></codeline>
<codeline lineno="1679"><highlight class="normal"></highlight></codeline>
<codeline lineno="1680"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">main():</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/>parser<sp/>=<sp/>argparse.ArgumentParser(description=</highlight><highlight class="stringliteral">&apos;espcoredump.py<sp/>v%s<sp/>-<sp/>ESP32<sp/>Core<sp/>Dump<sp/>Utility&apos;</highlight><highlight class="normal"><sp/>%<sp/>__version__,<sp/>prog=</highlight><highlight class="stringliteral">&apos;espcoredump&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"></highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/>parser.add_argument(</highlight><highlight class="stringliteral">&apos;--chip&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-c&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Target<sp/>chip<sp/>type&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>choices=[</highlight><highlight class="stringliteral">&apos;auto&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;esp32&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default=os.environ.get(</highlight><highlight class="stringliteral">&apos;ESPTOOL_CHIP&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;auto&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"></highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/>parser.add_argument(</highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--port&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-p&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Serial<sp/>port<sp/>device&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default=os.environ.get(</highlight><highlight class="stringliteral">&apos;ESPTOOL_PORT&apos;</highlight><highlight class="normal">,<sp/>esptool.ESPLoader.DEFAULT_PORT))</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"></highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/>parser.add_argument(</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;--baud&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-b&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Serial<sp/>port<sp/>baud<sp/>rate<sp/>used<sp/>when<sp/>flashing/reading&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type=int,</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>default=os.environ.get(</highlight><highlight class="stringliteral">&apos;ESPTOOL_BAUD&apos;</highlight><highlight class="normal">,<sp/>esptool.ESPLoader.ESP_ROM_BAUD))</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"></highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/>subparsers<sp/>=<sp/>parser.add_subparsers(</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dest=</highlight><highlight class="stringliteral">&apos;operation&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Run<sp/>coredumper<sp/>{command}<sp/>-h<sp/>for<sp/>additional<sp/>help&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"></highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump<sp/>=<sp/>subparsers.add_parser(</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dbg_corefile&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Starts<sp/>GDB<sp/>debugging<sp/>session<sp/>with<sp/>specified<sp/>corefile&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--debug&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-d&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Log<sp/>level<sp/>(0..3)&apos;</highlight><highlight class="normal">,<sp/>type=int,<sp/>default=3)</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--gdb&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-g&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>gdb&apos;</highlight><highlight class="normal">,<sp/>default=</highlight><highlight class="stringliteral">&apos;xtensa-esp32-elf-gdb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--core&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-c&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>core<sp/>dump<sp/>file<sp/>(if<sp/>skipped<sp/>core<sp/>dump<sp/>will<sp/>be<sp/>read<sp/>from<sp/>flash)&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--core-format&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-t&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;(elf,<sp/>raw<sp/>or<sp/>b64).<sp/>File<sp/>specified<sp/>with<sp/>&quot;-c&quot;<sp/>is<sp/>an<sp/>ELF<sp/>(&quot;elf&quot;),<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;raw<sp/>(raw)<sp/>or<sp/>base64-encoded<sp/>(b64)<sp/>binary&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>choices=[</highlight><highlight class="stringliteral">&apos;b64&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;raw&apos;</highlight><highlight class="normal">],<sp/>type=str,<sp/>default=</highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--off&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-o&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Ofsset<sp/>of<sp/>coredump<sp/>partition<sp/>in<sp/>flash<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;(type<sp/>&quot;make<sp/>partition_table&quot;<sp/>to<sp/>see).&apos;</highlight><highlight class="normal">,<sp/>type=int,<sp/>default=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--save-core&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-s&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Save<sp/>core<sp/>to<sp/>file.<sp/>Othwerwise<sp/>temporary<sp/>core<sp/>file<sp/>will<sp/>be<sp/>deleted.<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Ignored<sp/>with<sp/>&quot;-c&quot;&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--rom-elf&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-r&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>ROM<sp/>ELF<sp/>file.&apos;</highlight><highlight class="normal">,<sp/>type=str,<sp/>default=</highlight><highlight class="stringliteral">&apos;esp32_rom.elf&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_debug_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;prog&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>program\&apos;s<sp/>ELF<sp/>binary&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"></highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump<sp/>=<sp/>subparsers.add_parser(</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;info_corefile&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>help=</highlight><highlight class="stringliteral">&apos;Print<sp/>core<sp/>dump<sp/>info<sp/>from<sp/>file&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--debug&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-d&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Log<sp/>level<sp/>(0..3)&apos;</highlight><highlight class="normal">,<sp/>type=int,<sp/>default=3)</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--gdb&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-g&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>gdb&apos;</highlight><highlight class="normal">,<sp/>default=</highlight><highlight class="stringliteral">&apos;xtensa-esp32-elf-gdb&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--core&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-c&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>core<sp/>dump<sp/>file<sp/>(if<sp/>skipped<sp/>core<sp/>dump<sp/>will<sp/>be<sp/>read<sp/>from<sp/>flash)&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--core-format&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-t&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;(elf,<sp/>raw<sp/>or<sp/>b64).<sp/>File<sp/>specified<sp/>with<sp/>&quot;-c&quot;<sp/>is<sp/>an<sp/>ELF<sp/>(&quot;elf&quot;),<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;raw<sp/>(raw)<sp/>or<sp/>base64-encoded<sp/>(b64)<sp/>binary&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>choices=[</highlight><highlight class="stringliteral">&apos;b64&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;raw&apos;</highlight><highlight class="normal">],<sp/>type=str,<sp/>default=</highlight><highlight class="stringliteral">&apos;elf&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--off&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-o&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Offset<sp/>of<sp/>coredump<sp/>partition<sp/>in<sp/>flash<sp/>(type<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&quot;make<sp/>partition_table&quot;<sp/>to<sp/>see).&apos;</highlight><highlight class="normal">,<sp/>type=int,<sp/>default=</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--save-core&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-s&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Save<sp/>core<sp/>to<sp/>file.<sp/>Othwerwise<sp/>temporary<sp/>core<sp/>file<sp/>will<sp/>be<sp/>deleted.<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Does<sp/>not<sp/>work<sp/>with<sp/>&quot;-c&quot;&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--rom-elf&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-r&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>ROM<sp/>ELF<sp/>file.&apos;</highlight><highlight class="normal">,<sp/>type=str,<sp/>default=</highlight><highlight class="stringliteral">&apos;esp32_rom.elf&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;--print-mem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-m&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Print<sp/>memory<sp/>dump&apos;</highlight><highlight class="normal">,<sp/>action=</highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/>parser_info_coredump.add_argument(</highlight><highlight class="stringliteral">&apos;prog&apos;</highlight><highlight class="normal">,<sp/>help=</highlight><highlight class="stringliteral">&apos;Path<sp/>to<sp/>program\&apos;s<sp/>ELF<sp/>binary&apos;</highlight><highlight class="normal">,<sp/>type=str)</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"></highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>internal<sp/>sanity<sp/>check<sp/>-<sp/>every<sp/>operation<sp/>matches<sp/>a<sp/>module<sp/>function<sp/>of<sp/>the<sp/>same<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>operation<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>subparsers.choices:</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>operation<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>globals(),<sp/></highlight><highlight class="stringliteral">&quot;%s<sp/>should<sp/>be<sp/>a<sp/>module<sp/>function&quot;</highlight><highlight class="normal"><sp/>%<sp/>operation</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/>args<sp/>=<sp/>parser.parse_args()</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.CRITICAL</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args.debug<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.CRITICAL</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>args.debug<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.ERROR</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>args.debug<sp/>==<sp/>2:</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.WARNING</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>args.debug<sp/>==<sp/>3:</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.INFO</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log_level<sp/>=<sp/>logging.DEBUG</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/>logging.basicConfig(format=</highlight><highlight class="stringliteral">&apos;%(levelname)s:<sp/>%(message)s&apos;</highlight><highlight class="normal">,<sp/>level=log_level)</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"></highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;espcoredump.py<sp/>v%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>__version__)</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"></highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/>operation_func<sp/>=<sp/>globals()[args.operation]</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/>operation_func(args)</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"></highlight></codeline>
<codeline lineno="1760"><highlight class="normal"></highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>main()</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ESPCoreDumpError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>e:</highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;\nA<sp/>fatal<sp/>error<sp/>occurred:<sp/>%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>e)</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.exit(2)</highlight></codeline>
    </programlisting>
    <location file="espcoredump.py"/>
  </compounddef>
</doxygen>
